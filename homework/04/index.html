<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/PDE/css/franklin.css"> <link rel=stylesheet  href="/PDE/css/tufte.css"> <link rel=stylesheet  href="/PDE/css/latex.css"> <link rel=stylesheet  href="/PDE/css/adjust.css"> <link rel=icon  href="/PDE/assets/favicon.png"> <title>Homework 04 Fourier Spaces</title> <div id=layout > <div id=menu > <ul> <li><a style="font-size:larger;" href="/PDE/">Home</a> <li><a style="font-size:larger;" href="/PDE/homework/">Homework</a> <li><a style="font-size:larger;" href="/PDE/schedule/">Course Schedule</a> <li><a style="font-size:larger;" href="/PDE/bibliography/">Bibliography</a> <!-- <li><a style="font-size:larger;" href="/PDE/notes/">Notes</a> <ul style="font-size:smaller"> <li><a href="/PDE/notes/lecture01/">01: Linear Algebra</a> <li><a href="/PDE/notes/lecture02/">02: Topology</a> <li><a href="/PDE/notes/lecture05/">05: ODEs</a> </ul> --> </ul> </div> <div id=main > <div class=franklin-content > <!DOCTYPE html> <HTML lang = "en"> <HEAD> <meta charset=UTF-8 /> <meta name=viewport  content="width=device-width, initial-scale=1.0, user-scalable=yes"> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}, TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style> pre.hljl { border: 1px solid #ccc; margin: 5px; padding: 5px; overflow-x: auto; color: rgb(68,68,68); background-color: rgb(251,251,251); } pre.hljl > span.hljl-t { } pre.hljl > span.hljl-w { } pre.hljl > span.hljl-e { } pre.hljl > span.hljl-eB { } pre.hljl > span.hljl-o { } pre.hljl > span.hljl-k { color: rgb(148,91,176); font-weight: bold; } pre.hljl > span.hljl-kc { color: rgb(59,151,46); font-style: italic; } pre.hljl > span.hljl-kd { color: rgb(214,102,97); font-style: italic; } pre.hljl > span.hljl-kn { color: rgb(148,91,176); font-weight: bold; } pre.hljl > span.hljl-kp { color: rgb(148,91,176); font-weight: bold; } pre.hljl > span.hljl-kr { color: rgb(148,91,176); font-weight: bold; } pre.hljl > span.hljl-kt { color: rgb(148,91,176); font-weight: bold; } pre.hljl > span.hljl-n { } pre.hljl > span.hljl-na { } pre.hljl > span.hljl-nb { } pre.hljl > span.hljl-nbp { } pre.hljl > span.hljl-nc { } pre.hljl > span.hljl-ncB { } pre.hljl > span.hljl-nd { color: rgb(214,102,97); } pre.hljl > span.hljl-ne { } pre.hljl > span.hljl-neB { } pre.hljl > span.hljl-nf { color: rgb(66,102,213); } pre.hljl > span.hljl-nfm { color: rgb(66,102,213); } pre.hljl > span.hljl-np { } pre.hljl > span.hljl-nl { } pre.hljl > span.hljl-nn { } pre.hljl > span.hljl-no { } pre.hljl > span.hljl-nt { } pre.hljl > span.hljl-nv { } pre.hljl > span.hljl-nvc { } pre.hljl > span.hljl-nvg { } pre.hljl > span.hljl-nvi { } pre.hljl > span.hljl-nvm { } pre.hljl > span.hljl-l { } pre.hljl > span.hljl-ld { color: rgb(148,91,176); font-style: italic; } pre.hljl > span.hljl-s { color: rgb(201,61,57); } pre.hljl > span.hljl-sa { color: rgb(201,61,57); } pre.hljl > span.hljl-sb { color: rgb(201,61,57); } pre.hljl > span.hljl-sc { color: rgb(201,61,57); } pre.hljl > span.hljl-sd { color: rgb(201,61,57); } pre.hljl > span.hljl-sdB { color: rgb(201,61,57); } pre.hljl > span.hljl-sdC { color: rgb(201,61,57); } pre.hljl > span.hljl-se { color: rgb(59,151,46); } pre.hljl > span.hljl-sh { color: rgb(201,61,57); } pre.hljl > span.hljl-si { } pre.hljl > span.hljl-so { color: rgb(201,61,57); } pre.hljl > span.hljl-sr { color: rgb(201,61,57); } pre.hljl > span.hljl-ss { color: rgb(201,61,57); } pre.hljl > span.hljl-ssB { color: rgb(201,61,57); } pre.hljl > span.hljl-nB { color: rgb(59,151,46); } pre.hljl > span.hljl-nbB { color: rgb(59,151,46); } pre.hljl > span.hljl-nfB { color: rgb(59,151,46); } pre.hljl > span.hljl-nh { color: rgb(59,151,46); } pre.hljl > span.hljl-ni { color: rgb(59,151,46); } pre.hljl > span.hljl-nil { color: rgb(59,151,46); } pre.hljl > span.hljl-noB { color: rgb(59,151,46); } pre.hljl > span.hljl-oB { color: rgb(102,102,102); font-weight: bold; } pre.hljl > span.hljl-ow { color: rgb(102,102,102); font-weight: bold; } pre.hljl > span.hljl-p { } pre.hljl > span.hljl-c { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-ch { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-cm { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-cp { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-cpB { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-cs { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-csB { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-g { } pre.hljl > span.hljl-gd { } pre.hljl > span.hljl-ge { } pre.hljl > span.hljl-geB { } pre.hljl > span.hljl-gh { } pre.hljl > span.hljl-gi { } pre.hljl > span.hljl-go { } pre.hljl > span.hljl-gp { } pre.hljl > span.hljl-gs { } pre.hljl > span.hljl-gsB { } pre.hljl > span.hljl-gt { } </style> <style> @font-face { font-style: normal; font-weight: 300; } @font-face { font-style: normal; font-weight: 400; } @font-face { font-style: normal; font-weight: 600; } html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ } body { margin: 0; } article, aside, details, figcaption, figure, footer, header, hgroup, main, menu, nav, section, summary { display: block; } audio, canvas, progress, video { display: inline-block; /* 1 */ vertical-align: baseline; /* 2 */ } audio:not([controls]) { display: none; height: 0; } [hidden], template { display: none; } a:active, a:hover { outline: 0; } abbr[title] { border-bottom: 1px dotted; } b, strong { font-weight: bold; } dfn { font-style: italic; } h1 { font-size: 2em; margin: 0.67em 0; } mark { background: #ff0; color: #000; } small { font-size: 80%; } sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; } sup { top: -0.5em; } sub { bottom: -0.25em; } img { border: 0; } svg:not(:root) { overflow: hidden; } figure { margin: 1em 40px; } hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; } pre { overflow: auto; } code, kbd, pre, samp { font-family: monospace, monospace; font-size: 1em; } button, input, optgroup, select, textarea { color: inherit; /* 1 */ font: inherit; /* 2 */ margin: 0; /* 3 */ } button { overflow: visible; } button, select { text-transform: none; } button, html input[type="button"], /* 1 */ input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ } button[disabled], html input[disabled] { cursor: default; } button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; } input { line-height: normal; } input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ } input[type="number"]::-webkit-inner-spin-button, input[type="number"]::-webkit-outer-spin-button { height: auto; } input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; } input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; } fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; } legend { border: 0; /* 1 */ padding: 0; /* 2 */ } textarea { overflow: auto; } optgroup { font-weight: bold; } table { font-family: monospace, monospace; font-size : 0.8em; border-collapse: collapse; border-spacing: 0; } td, th { padding: 0; } thead th { border-bottom: 1px solid black; background-color: white; } tr:nth-child(odd){ background-color: rgb(248,248,248); } /* * Skeleton V2.0.4 * Copyright 2014, Dave Gamache * www.getskeleton.com * Free to use under the MIT license. * http://www.opensource.org/licenses/mit-license.php * 12/29/2014 */ .container { position: relative; width: 100%; max-width: 960px; margin: 0 auto; padding: 0 20px; box-sizing: border-box; } .column, .columns { width: 100%; float: left; box-sizing: border-box; } @media (min-width: 400px) { .container { width: 85%; padding: 0; } } @media (min-width: 550px) { .container { width: 80%; } .column, .columns { margin-left: 4%; } .column:first-child, .columns:first-child { margin-left: 0; } .one.column, .one.columns { width: 4.66666666667%; } .two.columns { width: 13.3333333333%; } .three.columns { width: 22%; } .four.columns { width: 30.6666666667%; } .five.columns { width: 39.3333333333%; } .six.columns { width: 48%; } .seven.columns { width: 56.6666666667%; } .eight.columns { width: 65.3333333333%; } .nine.columns { width: 74.0%; } .ten.columns { width: 82.6666666667%; } .eleven.columns { width: 91.3333333333%; } .twelve.columns { width: 100%; margin-left: 0; } .one-third.column { width: 30.6666666667%; } .two-thirds.column { width: 65.3333333333%; } .one-half.column { width: 48%; } /* Offsets */ .offset-by-one.column, .offset-by-one.columns { margin-left: 8.66666666667%; } .offset-by-two.column, .offset-by-two.columns { margin-left: 17.3333333333%; } .offset-by-three.column, .offset-by-three.columns { margin-left: 26%; } .offset-by-four.column, .offset-by-four.columns { margin-left: 34.6666666667%; } .offset-by-five.column, .offset-by-five.columns { margin-left: 43.3333333333%; } .offset-by-six.column, .offset-by-six.columns { margin-left: 52%; } .offset-by-seven.column, .offset-by-seven.columns { margin-left: 60.6666666667%; } .offset-by-eight.column, .offset-by-eight.columns { margin-left: 69.3333333333%; } .offset-by-nine.column, .offset-by-nine.columns { margin-left: 78.0%; } .offset-by-ten.column, .offset-by-ten.columns { margin-left: 86.6666666667%; } .offset-by-eleven.column, .offset-by-eleven.columns { margin-left: 95.3333333333%; } .offset-by-one-third.column, .offset-by-one-third.columns { margin-left: 34.6666666667%; } .offset-by-two-thirds.column, .offset-by-two-thirds.columns { margin-left: 69.3333333333%; } .offset-by-one-half.column, .offset-by-one-half.columns { margin-left: 52%; } } html { font-size: 62.5%; } body { font-size: 1.5em; /* currently ems cause chrome bug misinterpreting rems on body element */ line-height: 1.6; font-weight: 400; font-family: "Raleway", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif; color: #222; } h1, h2, h3, h4, h5, h6 { margin-top: 0; margin-bottom: 2rem; font-weight: 300; } h1 { font-size: 3.6rem; line-height: 1.2; letter-spacing: -.1rem;} h2 { font-size: 3.4rem; line-height: 1.25; letter-spacing: -.1rem; } h3 { font-size: 3.2rem; line-height: 1.3; letter-spacing: -.1rem; } h4 { font-size: 2.8rem; line-height: 1.35; letter-spacing: -.08rem; } h5 { font-size: 2.4rem; line-height: 1.5; letter-spacing: -.05rem; } h6 { font-size: 1.5rem; line-height: 1.6; letter-spacing: 0; } p { margin-top: 0; } a { color: #1EAEDB; } a:hover { color: #0FA0CE; } .button, button, input[type="submit"], input[type="reset"], input[type="button"] { display: inline-block; height: 38px; padding: 0 30px; color: #555; text-align: center; font-size: 11px; font-weight: 600; line-height: 38px; letter-spacing: .1rem; text-transform: uppercase; text-decoration: none; white-space: nowrap; background-color: transparent; border-radius: 4px; border: 1px solid #bbb; cursor: pointer; box-sizing: border-box; } .button:hover, button:hover, input[type="submit"]:hover, input[type="reset"]:hover, input[type="button"]:hover, .button:focus, button:focus, input[type="submit"]:focus, input[type="reset"]:focus, input[type="button"]:focus { color: #333; border-color: #888; outline: 0; } .button.button-primary, button.button-primary, input[type="submit"].button-primary, input[type="reset"].button-primary, input[type="button"].button-primary { color: #FFF; background-color: #33C3F0; border-color: #33C3F0; } .button.button-primary:hover, button.button-primary:hover, input[type="submit"].button-primary:hover, input[type="reset"].button-primary:hover, input[type="button"].button-primary:hover, .button.button-primary:focus, button.button-primary:focus, input[type="submit"].button-primary:focus, input[type="reset"].button-primary:focus, input[type="button"].button-primary:focus { color: #FFF; background-color: #1EAEDB; border-color: #1EAEDB; } input[type="email"], input[type="number"], input[type="search"], input[type="text"], input[type="tel"], input[type="url"], input[type="password"], textarea, select { height: 38px; padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */ background-color: #fff; border: 1px solid #D1D1D1; border-radius: 4px; box-shadow: none; box-sizing: border-box; } /* Removes awkward default styles on some inputs for iOS */ input[type="email"], input[type="number"], input[type="search"], input[type="text"], input[type="tel"], input[type="url"], input[type="password"], textarea { -webkit-appearance: none; -moz-appearance: none; appearance: none; } textarea { min-height: 65px; padding-top: 6px; padding-bottom: 6px; } input[type="email"]:focus, input[type="number"]:focus, input[type="search"]:focus, input[type="text"]:focus, input[type="tel"]:focus, input[type="url"]:focus, input[type="password"]:focus, textarea:focus, select:focus { border: 1px solid #33C3F0; outline: 0; } label, legend { display: block; margin-bottom: .5rem; font-weight: 600; } fieldset { padding: 0; border-width: 0; } input[type="checkbox"], input[type="radio"] { display: inline; } label > .label-body { display: inline-block; margin-left: .5rem; font-weight: normal; } ul { list-style: circle; } ol { list-style: decimal; } ul ul, ul ol, ol ol, ol ul { margin: 1.5rem 0 1.5rem 3rem; font-size: 90%; } li > p {margin : 0;} th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #E1E1E1; } th:first-child, td:first-child { padding-left: 0; } th:last-child, td:last-child { padding-right: 0; } button, .button { margin-bottom: 1rem; } input, textarea, select, fieldset { margin-bottom: 1.5rem; } pre, blockquote, dl, figure, table, p, ul, ol, form { margin-bottom: 1.0rem; } .u-full-width { width: 100%; box-sizing: border-box; } .u-max-full-width { max-width: 100%; box-sizing: border-box; } .u-pull-right { float: right; } .u-pull-left { float: left; } hr { margin-top: 3rem; margin-bottom: 3.5rem; border-width: 0; border-top: 1px solid #E1E1E1; } .container:after, .row:after, .u-cf { content: ""; display: table; clear: both; } pre { display: block; padding: 9.5px; margin: 0 0 10px; font-size: 13px; line-height: 1.42857143; word-break: break-all; word-wrap: break-word; border: 1px solid #ccc; border-radius: 4px; } pre.hljl { margin: 0 0 10px; display: block; background: #f5f5f5; border-radius: 4px; padding : 5px; } pre.output { background: #ffffff; } pre.code { background: #ffffff; } pre.julia-error { color : red } code, kbd, pre, samp { font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 0.9em; } @media (min-width: 400px) {} @media (min-width: 550px) {} @media (min-width: 750px) {} @media (min-width: 1000px) {} @media (min-width: 1200px) {} h1.title {margin-top : 20px} img {max-width : 100%} div.title {text-align: center;} </style> </HEAD> <BODY> <div class ="container"> <div class = "row"> <div class = "col-md-12 twelve columns"> <div class=title > </div> <p>with open&#40;OutputFile, &quot;w&quot;, encoding&#61;&quot;utf-8&quot;&#41; as f:## Homework 4: Fourier Analysis## Due date: ### Student Name:<strong>Exercise 1.</strong></p> <p>a.- Find the Fourier series of the function <span class=math >$f(x) := x$</span> in the interval <span class=math >$[-\pi,\pi]$</span>.</p> <p>b.- Use Parseval&#39;s relation to prove that \begin&#123;equation<em>&#125; \sum_&#123;n&#61;1&#125;^&#123;\infty&#125; \frac&#123;1&#125;&#123;n^2&#125; &#61; \pi^2/6 \end&#123;equation</em>&#125;</p> <p><strong>Exercise 2.</strong></p> <p>a.- Find the Fourier series of the function <span class=math >$f(x):= e^{sx}$</span> in the interval <span class=math >$[-\pi, \pi]$</span>.</p> <p>b.- Use Parseval&#39;s relation to prove that \begin&#123;equation<em>&#125; \pi coth&#40;\pi s&#41;/s &#61; \sum_&#123;n&#61;-\infty&#125;^&#123;\infty&#125; \frac&#123;1&#125;&#123;s^2&#43;n^2&#125; \end&#123;equation</em>&#125;</p> <p><strong>Exercise 3.</strong></p> <p>Let <span class=math >$S_n: L^2 \to L^2$</span> be the map that sends <span class=math >$f \in L^2$</span> to the partial Fourier series, \begin&#123;equation<em>&#125; S<em>n&#40;f&#41; :&#61; \sum</em>&#123;m&#61;-n&#125;^&#123;n&#125; c<em>m e^&#123;imx&#125;, \;\;\;\;\;\;\; c</em>m:&#61; \frac&#123;1&#125;&#123;2\pi&#125;\langle e^&#123;imx&#125;,f&#40;x&#41; \rangle. \end&#123;equation</em>&#125; Show that the <span class=math >$S_n$</span> are orthogonal projections and that <span class=math >$S_n S_m = S_m S_n = S_m$</span> if <span class=math >$m \leq n$</span>.</p> <p><strong>Exercise 4. Use of the Fourier Interpolation</strong></p> <p>Compute the Fourier Interpolation of the functions: <span class=math >$|x|$</span>, <span class=math >$sign(x)$</span>, and <span class=math >$sin(x)+ 3cos(x)$</span> and <span class=math >$e^{sx}$</span> &#40;for <span class=math >$s= 1, 3, 3i$</span>&#41; and plot it along the Fourier series coefficients. Below is an example:<code>juliausing Pkg Pkg.instantiate&#40;&#41; using FFTW using Plots</code><code>juliaN &#61; 64 f&#40;x&#41; &#61; x #f&#40;x&#41; &#61; x*sign&#40;x&#41; #f&#40;x&#41; &#61; exp&#40;2*x&#41; xi &#61; -π xf &#61; π xv &#61; &#91;xi &#43; &#40;xf-xi&#41;*&#40;i-1&#41;/N for i in 1:N&#93; fv &#61; f.&#40;xv&#41; plot&#40;xv,fv, label&#61;&quot;f&#40;x&#41;&#61;x&quot;&#41;</code>The Fourier coefficients of <span class=math >$f(x)=x$</span> in the interval <span class=math >$[-π,π]$</span> are <span class=math >$b_n=i/n$</span>, <span class=math >$n\neq 0$</span>, <span class=math >$b_0 = 0$</span>. While the Fourier Interpolant is: <span class=math >$i_n = 1/(e^{-i2πn}-1)$</span>. <code>juliafreq &#61; fftshift&#40;rfftfreq&#40;N&#41;&#41;*N rft &#61; rfft&#40;fv&#41; #fftf &#61; fft&#40;fv&#41; bn &#61; N ./freq #for f&#40;x&#41;&#61;x an &#61; 1 ./ &#40;freq.^2&#41;/N/π*2 #for f&#40;x&#41;&#61;x*sign&#40;x&#41; in &#61; 2*π ./&#40; exp.&#40;-im*2*π*freq/N&#41; .- 1&#41; scatter&#40;freq,real.&#40;rft&#41;, label&#61;&quot;real&quot;, markersize&#61;4&#41; scatter&#33;&#40;freq,imag.&#40;rft&#41;, label&#61;&quot;imag&quot;&#41; scatter&#33;&#40;freq,bn, label &#61; &quot;1/n&quot; &#41; #scatter&#33;&#40;freq,an, label&#61;&quot;2N/π/n^2&quot;&#41; scatter&#33;&#40;freq,real.&#40;in&#41;, label&#61;&quot;real_fi&quot;, markersize&#61;2&#41; scatter&#33;&#40;freq,imag.&#40;in&#41;, label&#61;&quot;imag_fi&quot;, markersize&#61;2&#41;</code>### For future use we construct an Fourier interpolant for functions in &#91;0,2π&#93;<code>juliaf&#40;x&#41; &#61; sign&#40;mod&#40;x,2π&#41;-π&#41; #it works fine with this, except at zero &#40;because of periodicity issues&#41; #f&#40;x&#41; &#61; -&#40;x*&#40;1-sign&#40;x-π&#41;&#41; &#43; &#40;x-2π&#41;*&#40;sign&#40;x-π&#41;&#43;1&#41;&#41; /2/π #it does not work with this. #f&#40;x&#41; &#61; sin&#40;x&#41; &#43; sin&#40;3*x&#41;/3 &#43; sin&#40;5*x&#41;/5 #it works fine with this. plot&#40;f, 0, 2π, label&#61;&quot;f&#40;x&#41;&quot;&#41;</code>&#96;&#96;&#96;julia&quot;&quot;&quot; fourier_interpolant&#40;f::Vector, T&#61;2π&#41;</p> <p>Compute the Fourier interpolant <code>P&#40;x&#41;</code> of a periodic signal sampled uniformly over &#91;0, T&#41;.</p> <h1>Arguments</h1> <ul> <li><p><code>f</code>: Vector of function values <code>&#91;f₁, f₂, ..., f_N&#93;</code> sampled at <code>xₙ &#61; &#40;n-1&#41; * T/N</code>.</p> <li><p><code>T</code>: Period of the signal &#40;default: <code>2π</code>&#41;.</p> </ul> <h1>Returns</h1> <ul> <li><p>A function <code>P&#40;x&#41;</code> that evaluates the Fourier interpolant at any <code>x</code>.</p> </ul> <p>&quot;&quot;&quot; function fourier_interpolant&#40;f::Vector, T&#61;2π&#41; N &#61; length&#40;f&#41; Δx &#61; T / N</p> <pre><code># Compute normalized DFT coefficients
F &#61; fft&#40;f&#41; / N

# Frequencies in FFT order &#40;0, 1, ..., N/2, -N/2&#43;1, ..., -1&#41;
k &#61; fftfreq&#40;N&#41; * N  # Integer frequencies

# Precompute coefficients for the interpolant
function P&#40;x&#41;
    # Map x to &#91;0, T&#41; for periodicity
    x_mod &#61; mod&#40;x, T&#41;
    # Sum over all frequency components
    sum&#40;F&#91;m&#43;1&#93; * exp&#40;2π * im * k&#91;m&#43;1&#93; * x_mod / T&#41; for m in 0:N-1&#41; |&gt; real
end

return P</code></pre> <p>end&#96;&#96;&#96;&#96;&#96;&#96;juliaN &#61; 32 T &#61; 2π ff&#40;x&#41; &#61; cos&#40;x&#41; &#43; 0.5<em>sin.&#40;5</em>x&#41; x<em>sampled &#61; range&#40;0, 2π, length&#61;N&#43;1&#41;&#91;1:N&#93; # Sample over &#91;0, 2π&#41; f</em>sampled &#61; ff.&#40;x_sampled&#41; # Sampled function values</p> <p>P &#61; fourier<em>interpolant&#40;f</em>sampled, T&#41; x<em>eval &#61; range&#40;-π, 3π, length&#61;1000&#41; # Test periodicity P</em>eval &#61; P.&#40;x_eval&#41;</p> <p>plot&#40;x<em>eval, P</em>eval, label&#61;&quot;Fourier Interpolant &#40;N&#61;N&#41;&quot;, linewidth&#61;2&#41; plot&#33;&#40;x<em>eval, ff.&#40;x</em>eval&#41;, label&#61;&quot;True f&#40;x&#41;&quot;, linestyle&#61;:dash&#41; scatter&#33;&#40;x<em>sampled, f</em>sampled, label&#61;&quot;Sampled Points&quot;, color&#61;:red&#41; title&#33;&#40;&quot;Fourier Interpolation&quot;&#41; xlabel&#33;&#40;&quot;x&quot;&#41;&#96;&#96;&#96;&#96;&#96;&#96;juliaf<em>sampled &#61; f.&#40;x</em>sampled&#41; P &#61; fourier<em>interpolant</em>1&#40;f<em>sampled, T&#41; P</em>eval &#61; P.&#40;x_eval&#41;</p> <p>plot&#40;x<em>eval, P</em>eval, label&#61;&quot;Fourier Interpolant &#40;N&#61;N&#41;&quot;, linewidth&#61;2&#41; plot&#33;&#40;x<em>eval, f.&#40;x</em>eval&#41;, label&#61;&quot;Exact function&quot;, linestyle&#61;:dash&#41; scatter&#33;&#40;x<em>sampled, f</em>sampled, label&#61;&quot;Sampled Points&quot;, color&#61;:red&#41; title&#33;&#40;&quot;Fourier Interpolation&quot;&#41; xlabel&#33;&#40;&quot;x&quot;&#41;&#96;&#96;&#96;<strong>Exercise 5. Use of the Fourier Interpolation</strong></p> <p>Play around and interpolate different functions with the tool just introduced.</p> <h3>The Fourier Interpolant of a delta function.</h3> <p>We approximate a delta function distribution by a sequence of continuous functions;</p> <p class=math >\[ f(x,x_0,n) = \left(\begin{align} (x-x_0-1/n*n &\;\; x \in [x_0-1/n,x_0] \nonumber\\ (x_0+1/n-x)*n &\;\; x \in [x_0,x_0+1/n] \nonumber\\ 0 &\;\; x \notin [x_0-1/n,x_0+1/n] \nonumber \end{align} \right. \]</p> <pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>&amp;&amp;</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;=</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-t'>
        </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>x0</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-n'>n</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
    </span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-t'> </span><span class='hljl-oB'>&amp;&amp;</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-t'>
        </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>x0</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-n'>n</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
    </span><span class='hljl-k'>else</span><span class='hljl-t'>
        </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=output >
f_n &#40;generic function with 1 method&#41;
</pre> <pre class='hljl'>
<span class='hljl-n'>x0</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>
</span><span class='hljl-nf'>f1</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>f2</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>f3</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>f6</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>6</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>f9</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>9</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>f18</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>18</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;f_1(x)&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>f2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;f_2(x)&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>f3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;f_3(x)&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-sb'>```The real parts get higher and higher frequency components. ```</span><span class='hljl-nf'>juliascatter</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f1</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_1(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f1</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_1(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#scatter!(real.(rfft(f2.(xv))), label=&quot;Ff_2(x)&quot;)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f2</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_2(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_3(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>  
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_3(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f6</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_6(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f6</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_6(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f9</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_9(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f9</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_9(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f18</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_18(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f18</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_18(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f1</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_1(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-sb'>```The imaginary parts are all very small.```</span><span class='hljl-nf'>juliascatter</span><span class='hljl-p'>(</span><span class='hljl-n'>imag</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f1</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_1(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#scatter!(imag.(rfft(f2.(xv))), label=&quot;Ff_2(x)&quot;)    </span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>imag</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_3(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>imag</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f6</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_6(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>imag</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f9</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_9(x)&quot;</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;plot&#96; not defined in &#96;Main.var&quot;##WeaveSandBox#230&quot;&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p><strong>Exercise 6. Interpolation of distributions</strong></p> <p>Try to deduce what is the limiting interpolant. Not only for the case of <span class=math >$x_0=0$</span>, but in general. Then compare with the exact value for it. </p> <HR/> <div class=footer > <p> Published from <a href=Fourier.jmd >Fourier.jmd</a> using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.12 on 2025-05-07. </p> </div> </div> </div> </div> </BODY> </HTML> <div class=page-foot > Last modified: May 07, 2025. <br> Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div>