<!DOCTYPE html> <html lang=en > <meta charset=UTF-8 > <title></title> <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/PDE/css/franklin.css"> <link rel=stylesheet  href="/PDE/css/tufte.css"> <link rel=stylesheet  href="/PDE/css/adjust.css"> <link rel=stylesheet  href="/PDE/css/latex.css"> <link rel=stylesheet  href="/PDE/css/weave.css"> <style> </style> <script> window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }, svg: { fontCache: 'global' } }; </script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" async></script> <div class=franklin-content > <ul> <li><p><a href="/PDE/weave/lab07/Poisson_example_cap.ipynb">Click here to download this notebook</a></p> </ul> <h1>Example of solving the Poisson problem with different boundary conditions and manipulation of the solution for the capacitance calculation problem</h1> <p>The problem to be solved is:</p> <p class=math >\[ \begin{align} -\Delta u &= f \;\;\;\;\; \text{in } \Omega \\ u &= g \;\;\;\;\; \text{in } \partial \Omega_{int} \\ \hat{n} \cdot \nabla u &= h \;\;\;\;\; \text{in } \partial \Omega_{ext} \\ \end{align} \]</p> <p>To do this, we will impose its weak form:</p> <p>Find <span class=math >$u$</span> in <span class=math >$H^1(\Omega, f))$</span> &#40;that is, with Dirichlet boundary conditions on <span class=math >$\partial \Omega_{int}$</span>&#41; such that,</p> <p class=math >\[ \int_{\Omega} \nabla v \cdot \nabla u \; d\Omega - \int_{\Omega} v \; f \; d\Omega - \oint_{\partial \Omega_{ext}} v \; h \; d\Gamma = 0 \;\;\;\;\; \forall v \;\; \in H^1_0(\Omega) \]</p> <p>If we obtain a <span class=math >$u$</span> satisfying this equation, and it is sufficiently smooth, then we can integrate the first term by parts and obtain:</p> <p class=math >\[ \int_{\Omega} v \; (-\Delta u - f) \; d\Omega + \oint_{\partial \Omega_{ext}} v \; (\hat{n} \cdot \nabla u - h) \; d\Gamma = 0 \;\;\;\;\; \forall v \;\; \in H^1_0(\Omega) \]</p> <p>Taking <span class=math >$v$</span> arbitrary but with compact support, we see that <span class=math >$u$</span> must satisfy:</p> <p class=math >\[ -\Delta u = f \;\;\;\;\; \text{in } \Omega, \]</p> <p>and taking <span class=math >$v$</span> arbitrary we also see that the Neumann condition must be satisfied,</p> <p class=math >\[ \hat{n} \cdot \nabla u = h \;\;\;\;\; \text{in } \partial \Omega_{ext}. \]</p> <p>The Dirichlet condition is automatic due to the choice of space.</p> <p>We will then use the solution found for a capacitance problem.</p> <p>To solve the problem, we will use the infrastructure of the Julia package <code>Gridap.jl</code>. This example is a compilation of several examples from the package&#39;s tutorial.</p> <pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Gridap</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>FileIO</span><span class='hljl-t'> </span><span class='hljl-cs'>#Gráficos y salidas</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>GridapGmsh</span><span class='hljl-t'>
</span><span class='hljl-cs'>#using gmsh #]add https://github.com/koehlerson/gmsh.jl.git</span><span class='hljl-t'>
</span><span class='hljl-cs'>#NEVER USE using Gmsh!!!</span><span class='hljl-t'>
</span><span class='hljl-cs'>#import Gmsh: gmsh</span>
</pre> <pre class='hljl'>
<span class='hljl-cs'>#plot_s = false #true</span><span class='hljl-t'>
</span><span class='hljl-n'>plot_s</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>true</span><span class='hljl-t'>
</span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>plot_s</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#using Pkg; Pkg.activate(&quot;./gridap_makie&quot;)</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Pkg.add(Pkg.PackageSpec(;name=&quot;Makie&quot;, version=&quot;0.12&quot;))</span><span class='hljl-t'>
    </span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Makie</span><span class='hljl-t'>
    </span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>GridapMakie</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>GLMakie</span><span class='hljl-t'> </span><span class='hljl-cs'>#Para graficar </span><span class='hljl-t'>
    </span><span class='hljl-n'>GLMakie</span><span class='hljl-oB'>.</span><span class='hljl-nf'>activate!</span><span class='hljl-p'>(</span><span class='hljl-n'>inline</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'># For windows on the notebook itself. Comment out if you want the as pop-out plots.</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=julia-error >
ERROR: ArgumentError: Package Makie not found in current path.
- Run &#96;import Pkg; Pkg.add&#40;&quot;Makie&quot;&#41;&#96; to install the Makie package.
</pre> <p>We will use meshes built with the <code>gmsh</code> library, through the script <code>mesh_generator.jl</code>. Note that in the script, the three boundaries are named: the external &#40;rectangular&#41; one as <code>&quot;ext&quot;</code> and the internal ones as <code>&quot;inner_circle&quot;</code> and <code>&quot;inner_square&quot;</code>. Based on the script and following the <code>gmsh</code> tutorial, you can build other meshes as well. Other libraries can also be used to build meshes. These are imported into the <strong>Gridap</strong> infrastructure, and with them the triangulation to be used is constructed.</p> <pre class='hljl'>
<span class='hljl-n'>create_grid</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-t'>

</span><span class='hljl-cs'>#Grid resolution:</span><span class='hljl-t'>
</span><span class='hljl-n'>res</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-cs'># 1, 2 or 3</span>
</pre> <pre class=output >
1
</pre> <pre class='hljl'>
<span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>create_grid</span><span class='hljl-t'>

</span><span class='hljl-nf'>include</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;mesh_generator.jl&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>grid_type</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;rectangle_hole_square&quot;</span><span class='hljl-t'>

</span><span class='hljl-cs'>#Resoluciones:</span><span class='hljl-t'>
</span><span class='hljl-n'>res</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>

</span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>res</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
    </span><span class='hljl-n'>lc</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1e-1</span><span class='hljl-t'>
    </span><span class='hljl-n'>lc_f</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.25e-1</span><span class='hljl-t'>
    </span><span class='hljl-n'>name</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>grid_type</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;_coarse&quot;</span><span class='hljl-t'>
</span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>res</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'> 
    </span><span class='hljl-n'>lc</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>5e-2</span><span class='hljl-t'>
    </span><span class='hljl-n'>lc_f</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>2.5e-2</span><span class='hljl-t'>
    </span><span class='hljl-n'>name</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>grid_type</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;_intermediate&quot;</span><span class='hljl-t'>
</span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>res</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-t'>
    </span><span class='hljl-n'>lc</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1e-2</span><span class='hljl-t'>
    </span><span class='hljl-n'>lc_f</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.25e-2</span><span class='hljl-t'>
    </span><span class='hljl-n'>name</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>grid_type</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;_finner&quot;</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>
    
</span><span class='hljl-cs'>#Lados exteriores de la grilla rectangular</span><span class='hljl-t'>
</span><span class='hljl-n'>side_x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>side_y</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>

</span><span class='hljl-cs'>#Rectangulo interior</span><span class='hljl-t'>
</span><span class='hljl-n'>rec_base</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.25</span><span class='hljl-t'>  </span><span class='hljl-cs'>#Coordenada y de la base</span><span class='hljl-t'>
</span><span class='hljl-n'>rec_top</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.75</span><span class='hljl-t'>   </span><span class='hljl-cs'>#Coordenada y del lado superior</span><span class='hljl-t'>
</span><span class='hljl-n'>rec_left</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.25</span><span class='hljl-t'>  </span><span class='hljl-cs'>#Coordenada x del lado izquierdo</span><span class='hljl-t'>
</span><span class='hljl-n'>rec_right</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.75</span><span class='hljl-t'> </span><span class='hljl-cs'>#Coordenada x del lado derecho</span><span class='hljl-t'>

</span><span class='hljl-cs'>#Circulo interior</span><span class='hljl-t'>
</span><span class='hljl-n'>circ_center_x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'>  </span><span class='hljl-cs'>#Coordenada x del centro</span><span class='hljl-t'>
</span><span class='hljl-n'>circ_center_y</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'>  </span><span class='hljl-cs'>#Coordenada y del centro</span><span class='hljl-t'>
</span><span class='hljl-n'>circ_radius</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.25</span><span class='hljl-t'>   </span><span class='hljl-cs'>#Radio</span><span class='hljl-t'>



</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>name</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>side_x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>side_y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>circ_center_x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>circ_center_y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>circ_radius</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rec_base</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rec_top</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rec_left</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rec_right</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>lc</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>lc_f</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>model</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>make_model</span><span class='hljl-p'>(</span><span class='hljl-n'>grid_type</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-k'>end</span>
</pre> <p>You can also upload the grid once is created and stored in the directory: models</p> <pre class='hljl'>
<span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>create_grid</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-t'>
    </span><span class='hljl-n'>model</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>GmshDiscreteModel</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;models/rectangle_hole_square_coarse.msh&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=julia-error >
ERROR: Msh file not found: models/rectangle_hole_square_coarse.msh
</pre> <pre class='hljl'>
<span class='hljl-n'>Ω</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Triangulation</span><span class='hljl-p'>(</span><span class='hljl-n'>model</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;model&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>degree</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-t'>
</span><span class='hljl-n'>dΩ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Measure</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>,</span><span class='hljl-n'>degree</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;Ω&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>plot_s</span><span class='hljl-t'>
    </span><span class='hljl-n'>fig</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ax</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>ax</span><span class='hljl-oB'>.</span><span class='hljl-n'>aspect</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>AxisAspect</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>wireframe!</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>black</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>marker</span><span class='hljl-oB'>=:</span><span class='hljl-n'>star8</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>markersize</span><span class='hljl-oB'>=</span><span class='hljl-ni'>4</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>blue</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>fig</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-nf'>display</span><span class='hljl-p'>(</span><span class='hljl-n'>fig</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;Ω&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p>We can also plot the different boundaries:</p> <pre class='hljl'>
<span class='hljl-n'>boundary_tags</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;inner_circle&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;inner_square&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;ext&quot;</span><span class='hljl-p'>]</span><span class='hljl-t'>

</span><span class='hljl-n'>Γ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>BoundaryTriangulation</span><span class='hljl-p'>(</span><span class='hljl-n'>model</span><span class='hljl-p'>,</span><span class='hljl-n'>tags</span><span class='hljl-oB'>=</span><span class='hljl-n'>boundary_tags</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>dΓ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Measure</span><span class='hljl-p'>(</span><span class='hljl-n'>Γ</span><span class='hljl-p'>,</span><span class='hljl-n'>degree</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>plot_s</span><span class='hljl-t'>
    </span><span class='hljl-n'>fig</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ax</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>Γ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>ax</span><span class='hljl-oB'>.</span><span class='hljl-n'>aspect</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>AxisAspect</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>wireframe!</span><span class='hljl-p'>(</span><span class='hljl-n'>Γ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>black</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>fig</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-nf'>display</span><span class='hljl-p'>(</span><span class='hljl-n'>fig</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;model&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p>We are going to choose two simple problems to calculate the capacitance matrix of a set of conductors. We will take the conductors as the two bodies: the circle and the square, and we will set constant potential conditions. The external boundary will be considered as <em>infinity</em> and we will always set the potential to zero there.</p> <pre class='hljl'>
<span class='hljl-n'>capacity_cs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-t'> </span><span class='hljl-cs'># potencial 1 en el círculo y potencial 0 en el cuadrado.</span><span class='hljl-t'>
</span><span class='hljl-n'>capacity_sc</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-t'> </span><span class='hljl-cs'># potencial 0 en el círculo y potencial 1 en el cuadrado.</span><span class='hljl-t'>
</span><span class='hljl-n'>capacity_cs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>true</span><span class='hljl-t'>
</span><span class='hljl-cs'>#capacity_sc = true</span>
</pre> <pre class=output >
true
</pre> <p>Once we have the mesh, we begin to define the finite elements that we will use. In this case, we will use Lagrangian elements of <strong>order 1</strong> that will satisfy a Dirichlet condition on the region <span class=math >$\partial \Omega_{int}$</span>. When the mesh is built, this region has been marked as the interior boundary of the rectangle with the <code>tag</code> <code>&quot;int&quot;</code>.</p> <pre class='hljl'>
<span class='hljl-n'>order</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
</span><span class='hljl-n'>reffe</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ReferenceFE</span><span class='hljl-p'>(</span><span class='hljl-n'>lagrangian</span><span class='hljl-p'>,</span><span class='hljl-n'>Float64</span><span class='hljl-p'>,</span><span class='hljl-n'>order</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>dirichlet_tags</span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;inner_circle&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;inner_square&quot;</span><span class='hljl-p'>,</span><span class='hljl-s'>&quot;ext&quot;</span><span class='hljl-p'>]</span><span class='hljl-t'> 

</span><span class='hljl-n'>V</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>TestFESpace</span><span class='hljl-p'>(</span><span class='hljl-n'>model</span><span class='hljl-p'>,</span><span class='hljl-n'>reffe</span><span class='hljl-p'>;</span><span class='hljl-n'>conformity</span><span class='hljl-oB'>=:</span><span class='hljl-n'>H1</span><span class='hljl-p'>,</span><span class='hljl-n'>dirichlet_tags</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>dirichlet_tags</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#V = TestFESpace(model,reffe;conformity=:L2,dirichlet_tags = dirichlet_tags) #no funciona la inversión.</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;model&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p>We now assign the boundary values:</p> <pre class='hljl'>
<span class='hljl-cs'># internal Dirichlet boundary condition</span><span class='hljl-t'>
</span><span class='hljl-nf'>g</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.0</span><span class='hljl-t'> </span><span class='hljl-cs'># esta puede ser una función de x (vector posición)</span><span class='hljl-t'>
</span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>capacity_cs</span><span class='hljl-t'>
    </span><span class='hljl-n'>U</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>TrialFESpace</span><span class='hljl-p'>(</span><span class='hljl-n'>V</span><span class='hljl-p'>,[</span><span class='hljl-n'>g</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>])</span><span class='hljl-t'>
</span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>capacity_sc</span><span class='hljl-t'>
    </span><span class='hljl-n'>U</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>TrialFESpace</span><span class='hljl-p'>(</span><span class='hljl-n'>V</span><span class='hljl-p'>,[</span><span class='hljl-nfB'>0.0</span><span class='hljl-t'> </span><span class='hljl-n'>g</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>])</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;V&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p>Next we define the weak problem in abstract form:</p> <pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'> </span><span class='hljl-cs'># in this case we are taking the source to vanish, but in principle we could put a charge distribution inside.</span><span class='hljl-t'>

</span><span class='hljl-nf'>a</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>v</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>∫</span><span class='hljl-p'>(</span><span class='hljl-t'> </span><span class='hljl-nf'>∇</span><span class='hljl-p'>(</span><span class='hljl-n'>v</span><span class='hljl-p'>)</span><span class='hljl-oB'>⋅</span><span class='hljl-nf'>∇</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-n'>dΩ</span><span class='hljl-t'>  </span><span class='hljl-cs'># in a(u,v) goes all the terms linear in the unknown, u. </span><span class='hljl-t'>

</span><span class='hljl-nf'>b</span><span class='hljl-p'>(</span><span class='hljl-n'>v</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>∫</span><span class='hljl-p'>(</span><span class='hljl-n'>v</span><span class='hljl-oB'>*</span><span class='hljl-n'>f</span><span class='hljl-t'> </span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-n'>dΩ</span><span class='hljl-t'> </span><span class='hljl-cs'># here everything else.</span>
</pre> <pre class=output >
b &#40;generic function with 1 method&#41;
</pre> <p>From this point on the package <strong>Gridap.jl</strong> generates a system of the form: <span class=math >$Ax=b$</span> and solves it for <span class=math >$u$</span> in the finite element version given. It first computes the matrices:</p> <pre class='hljl'>
<span class='hljl-n'>op</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>AffineFEOperator</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-n'>U</span><span class='hljl-p'>,</span><span class='hljl-n'>V</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;U&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p>Then it solves with some of the possible known strategies. Here we give two of them, the first is just an L-U decomposition &#40;Lower triangular Unitary&#41;. The second it the <code>/</code> operator of Julia, which in general would use the most powerful method for the case.</p> <pre class='hljl'>
<span class='hljl-n'>ls</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>LUSolver</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-n'>lb</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>BackslashSolver</span><span class='hljl-p'>()</span><span class='hljl-t'> </span><span class='hljl-cs'># x = A \ b</span><span class='hljl-t'>
</span><span class='hljl-n'>solver</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>LinearFESolver</span><span class='hljl-p'>(</span><span class='hljl-n'>lb</span><span class='hljl-p'>)</span>
</pre> <pre class=output >
LinearFESolver&#40;&#41;
</pre> <p>And we solve it. We call the solution <span class=math >$u_h$</span>.</p> <pre class='hljl'>
<span class='hljl-n'>uh</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>solver</span><span class='hljl-p'>,</span><span class='hljl-n'>op</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#uh = solve(op)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;op&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p>Now we can plot the found approximation and also save it in a format that can be given to Paraview or VisIt for ploting and processing.</p> <pre class='hljl'>
<span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>plot_s</span><span class='hljl-t'> 
    </span><span class='hljl-n'>fig</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ax</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>plt</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>uh</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>ax</span><span class='hljl-oB'>.</span><span class='hljl-n'>aspect</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>AxisAspect</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Colorbar</span><span class='hljl-p'>(</span><span class='hljl-n'>fig</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>plt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>vertical</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>fig</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;Ω&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>capacity_cs</span><span class='hljl-t'>
    </span><span class='hljl-nf'>writevtk</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>,</span><span class='hljl-s'>&quot;images/solucion_cs_</span><span class='hljl-si'>$res</span><span class='hljl-s'>&quot;</span><span class='hljl-p'>,</span><span class='hljl-n'>cellfields</span><span class='hljl-oB'>=</span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;uh_cs_</span><span class='hljl-si'>$res</span><span class='hljl-s'>&quot;</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>uh</span><span class='hljl-p'>])</span><span class='hljl-t'>
    </span><span class='hljl-nf'>writevtk</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>,</span><span class='hljl-s'>&quot;images/grad_cs_</span><span class='hljl-si'>$res</span><span class='hljl-s'>&quot;</span><span class='hljl-p'>,</span><span class='hljl-n'>cellfields</span><span class='hljl-oB'>=</span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;grad_uh_cs_</span><span class='hljl-si'>$res</span><span class='hljl-s'>&quot;</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>∇</span><span class='hljl-p'>(</span><span class='hljl-n'>uh</span><span class='hljl-p'>)])</span><span class='hljl-t'>
</span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>capacity_sc</span><span class='hljl-t'>
    </span><span class='hljl-nf'>writevtk</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>,</span><span class='hljl-s'>&quot;images/solucion_sc_</span><span class='hljl-si'>$res</span><span class='hljl-s'>&quot;</span><span class='hljl-p'>,</span><span class='hljl-n'>cellfields</span><span class='hljl-oB'>=</span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;uh_sc_</span><span class='hljl-si'>$res</span><span class='hljl-s'>&quot;</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>uh</span><span class='hljl-p'>])</span><span class='hljl-t'>
    </span><span class='hljl-nf'>writevtk</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>,</span><span class='hljl-s'>&quot;images/grad_cs_</span><span class='hljl-si'>$res</span><span class='hljl-s'>&quot;</span><span class='hljl-p'>,</span><span class='hljl-n'>cellfields</span><span class='hljl-oB'>=</span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;grad_uh_cs_</span><span class='hljl-si'>$res</span><span class='hljl-s'>&quot;</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>∇</span><span class='hljl-p'>(</span><span class='hljl-n'>uh</span><span class='hljl-p'>)])</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;uh&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p>Once we obtain the approximations we can compute some physical quantities of interest. Like, for instance, the charges on each of the conductors. Here we compute the charge in the exterior and interior. Note the sign change for the interior, this is due to the fact that the package takes alwais the normal pointing to the exterior of the mesh. </p> <p>Recall the charge is defined as: </p> <p>\begin&#123;equation&#125; Q<em>i &#61; \int</em>&#123;\partial \Omega<em>i&#125; \sigma dS &#61; \frac&#123;1&#125;&#123;4\pi&#125;\int</em>&#123;\partial \Omega_i&#125; E \cdot \; dS \end&#123;equation&#125;</p> <p>While the <strong>capacity matrix</strong> as: </p> <p>\begin&#123;equation&#125; Q<em>i &#61; C</em>&#123;ij&#125;V^j \end&#123;equation&#125;</p> <pre class='hljl'>
<span class='hljl-n'>Γ_ext</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>BoundaryTriangulation</span><span class='hljl-p'>(</span><span class='hljl-n'>model</span><span class='hljl-p'>,</span><span class='hljl-n'>tags</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;ext&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>dΓ_ext</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Measure</span><span class='hljl-p'>(</span><span class='hljl-n'>Γ_ext</span><span class='hljl-p'>,</span><span class='hljl-n'>degree</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>nb_ext</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>get_normal_vector</span><span class='hljl-p'>(</span><span class='hljl-n'>Γ_ext</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'># this is the normal to the boundary.</span><span class='hljl-t'>
</span><span class='hljl-n'>Q_ext</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-nf'>∫</span><span class='hljl-p'>((</span><span class='hljl-n'>nb_ext</span><span class='hljl-t'> </span><span class='hljl-oB'>⋅</span><span class='hljl-t'> </span><span class='hljl-nf'>∇</span><span class='hljl-p'>(</span><span class='hljl-n'>uh</span><span class='hljl-p'>)))</span><span class='hljl-oB'>*</span><span class='hljl-n'>dΓ_ext</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-oB'>/</span><span class='hljl-n'>π</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;model&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>Γ_square</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>BoundaryTriangulation</span><span class='hljl-p'>(</span><span class='hljl-n'>model</span><span class='hljl-p'>,</span><span class='hljl-n'>tags</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;inner_square&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>dΓ_square</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Measure</span><span class='hljl-p'>(</span><span class='hljl-n'>Γ_square</span><span class='hljl-p'>,</span><span class='hljl-n'>degree</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>nb_square</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>get_normal_vector</span><span class='hljl-p'>(</span><span class='hljl-n'>Γ_square</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>Q_square</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-nf'>∫</span><span class='hljl-p'>((</span><span class='hljl-n'>nb_square</span><span class='hljl-t'> </span><span class='hljl-oB'>⋅</span><span class='hljl-t'> </span><span class='hljl-nf'>∇</span><span class='hljl-p'>(</span><span class='hljl-n'>uh</span><span class='hljl-p'>)))</span><span class='hljl-oB'>*</span><span class='hljl-n'>dΓ_square</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-oB'>/</span><span class='hljl-n'>π</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;model&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>Γ_circle</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>BoundaryTriangulation</span><span class='hljl-p'>(</span><span class='hljl-n'>model</span><span class='hljl-p'>,</span><span class='hljl-n'>tags</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;inner_circle&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>dΓ_circle</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Measure</span><span class='hljl-p'>(</span><span class='hljl-n'>Γ_circle</span><span class='hljl-p'>,</span><span class='hljl-n'>degree</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>nb_circle</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>get_normal_vector</span><span class='hljl-p'>(</span><span class='hljl-n'>Γ_circle</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>Q_circle</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-nf'>∫</span><span class='hljl-p'>((</span><span class='hljl-n'>nb_circle</span><span class='hljl-t'> </span><span class='hljl-oB'>⋅</span><span class='hljl-t'> </span><span class='hljl-nf'>∇</span><span class='hljl-p'>(</span><span class='hljl-n'>uh</span><span class='hljl-p'>)))</span><span class='hljl-oB'>*</span><span class='hljl-n'>dΓ_circle</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-oB'>/</span><span class='hljl-n'>π</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;model&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>Q_ext</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>Q_circle</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>Q_square</span><span class='hljl-t'> </span><span class='hljl-cs'># this number should vanish if there are no sources (charges) present.</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;Q_ext&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p>We show an image with the program VisIt:</p> <p><img src="images/visit0004.png" alt="Una imagen con visIt" /></p> <pre class='hljl'>

</pre> <footer> <p> Published from <a href=Poisson_example_cap.ipynb >Poisson_example_cap.ipynb</a> using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.12 on 2025-06-18. </p> </footer> </div>