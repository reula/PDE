<!DOCTYPE html> <HTML lang = "en"> <HEAD> <meta charset=UTF-8 /> <meta name=viewport  content="width=device-width, initial-scale=1.0, user-scalable=yes"> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}, TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style> pre.hljl { border: 1px solid #ccc; margin: 5px; padding: 5px; overflow-x: auto; color: rgb(68,68,68); background-color: rgb(251,251,251); } pre.hljl > span.hljl-t { } pre.hljl > span.hljl-w { } pre.hljl > span.hljl-e { } pre.hljl > span.hljl-eB { } pre.hljl > span.hljl-o { } pre.hljl > span.hljl-k { color: rgb(148,91,176); font-weight: bold; } pre.hljl > span.hljl-kc { color: rgb(59,151,46); font-style: italic; } pre.hljl > span.hljl-kd { color: rgb(214,102,97); font-style: italic; } pre.hljl > span.hljl-kn { color: rgb(148,91,176); font-weight: bold; } pre.hljl > span.hljl-kp { color: rgb(148,91,176); font-weight: bold; } pre.hljl > span.hljl-kr { color: rgb(148,91,176); font-weight: bold; } pre.hljl > span.hljl-kt { color: rgb(148,91,176); font-weight: bold; } pre.hljl > span.hljl-n { } pre.hljl > span.hljl-na { } pre.hljl > span.hljl-nb { } pre.hljl > span.hljl-nbp { } pre.hljl > span.hljl-nc { } pre.hljl > span.hljl-ncB { } pre.hljl > span.hljl-nd { color: rgb(214,102,97); } pre.hljl > span.hljl-ne { } pre.hljl > span.hljl-neB { } pre.hljl > span.hljl-nf { color: rgb(66,102,213); } pre.hljl > span.hljl-nfm { color: rgb(66,102,213); } pre.hljl > span.hljl-np { } pre.hljl > span.hljl-nl { } pre.hljl > span.hljl-nn { } pre.hljl > span.hljl-no { } pre.hljl > span.hljl-nt { } pre.hljl > span.hljl-nv { } pre.hljl > span.hljl-nvc { } pre.hljl > span.hljl-nvg { } pre.hljl > span.hljl-nvi { } pre.hljl > span.hljl-nvm { } pre.hljl > span.hljl-l { } pre.hljl > span.hljl-ld { color: rgb(148,91,176); font-style: italic; } pre.hljl > span.hljl-s { color: rgb(201,61,57); } pre.hljl > span.hljl-sa { color: rgb(201,61,57); } pre.hljl > span.hljl-sb { color: rgb(201,61,57); } pre.hljl > span.hljl-sc { color: rgb(201,61,57); } pre.hljl > span.hljl-sd { color: rgb(201,61,57); } pre.hljl > span.hljl-sdB { color: rgb(201,61,57); } pre.hljl > span.hljl-sdC { color: rgb(201,61,57); } pre.hljl > span.hljl-se { color: rgb(59,151,46); } pre.hljl > span.hljl-sh { color: rgb(201,61,57); } pre.hljl > span.hljl-si { } pre.hljl > span.hljl-so { color: rgb(201,61,57); } pre.hljl > span.hljl-sr { color: rgb(201,61,57); } pre.hljl > span.hljl-ss { color: rgb(201,61,57); } pre.hljl > span.hljl-ssB { color: rgb(201,61,57); } pre.hljl > span.hljl-nB { color: rgb(59,151,46); } pre.hljl > span.hljl-nbB { color: rgb(59,151,46); } pre.hljl > span.hljl-nfB { color: rgb(59,151,46); } pre.hljl > span.hljl-nh { color: rgb(59,151,46); } pre.hljl > span.hljl-ni { color: rgb(59,151,46); } pre.hljl > span.hljl-nil { color: rgb(59,151,46); } pre.hljl > span.hljl-noB { color: rgb(59,151,46); } pre.hljl > span.hljl-oB { color: rgb(102,102,102); font-weight: bold; } pre.hljl > span.hljl-ow { color: rgb(102,102,102); font-weight: bold; } pre.hljl > span.hljl-p { } pre.hljl > span.hljl-c { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-ch { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-cm { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-cp { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-cpB { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-cs { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-csB { color: rgb(153,153,119); font-style: italic; } pre.hljl > span.hljl-g { } pre.hljl > span.hljl-gd { } pre.hljl > span.hljl-ge { } pre.hljl > span.hljl-geB { } pre.hljl > span.hljl-gh { } pre.hljl > span.hljl-gi { } pre.hljl > span.hljl-go { } pre.hljl > span.hljl-gp { } pre.hljl > span.hljl-gs { } pre.hljl > span.hljl-gsB { } pre.hljl > span.hljl-gt { } </style> <style> @font-face { font-style: normal; font-weight: 300; } @font-face { font-style: normal; font-weight: 400; } @font-face { font-style: normal; font-weight: 600; } html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ } body { margin: 0; } article, aside, details, figcaption, figure, footer, header, hgroup, main, menu, nav, section, summary { display: block; } audio, canvas, progress, video { display: inline-block; /* 1 */ vertical-align: baseline; /* 2 */ } audio:not([controls]) { display: none; height: 0; } [hidden], template { display: none; } a:active, a:hover { outline: 0; } abbr[title] { border-bottom: 1px dotted; } b, strong { font-weight: bold; } dfn { font-style: italic; } h1 { font-size: 2em; margin: 0.67em 0; } mark { background: #ff0; color: #000; } small { font-size: 80%; } sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; } sup { top: -0.5em; } sub { bottom: -0.25em; } img { border: 0; } svg:not(:root) { overflow: hidden; } figure { margin: 1em 40px; } hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; } pre { overflow: auto; } code, kbd, pre, samp { font-family: monospace, monospace; font-size: 1em; } button, input, optgroup, select, textarea { color: inherit; /* 1 */ font: inherit; /* 2 */ margin: 0; /* 3 */ } button { overflow: visible; } button, select { text-transform: none; } button, html input[type="button"], /* 1 */ input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ } button[disabled], html input[disabled] { cursor: default; } button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; } input { line-height: normal; } input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ } input[type="number"]::-webkit-inner-spin-button, input[type="number"]::-webkit-outer-spin-button { height: auto; } input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; } input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; } fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; } legend { border: 0; /* 1 */ padding: 0; /* 2 */ } textarea { overflow: auto; } optgroup { font-weight: bold; } table { font-family: monospace, monospace; font-size : 0.8em; border-collapse: collapse; border-spacing: 0; } td, th { padding: 0; } thead th { border-bottom: 1px solid black; background-color: white; } tr:nth-child(odd){ background-color: rgb(248,248,248); } /* * Skeleton V2.0.4 * Copyright 2014, Dave Gamache * www.getskeleton.com * Free to use under the MIT license. * http://www.opensource.org/licenses/mit-license.php * 12/29/2014 */ .container { position: relative; width: 100%; max-width: 960px; margin: 0 auto; padding: 0 20px; box-sizing: border-box; } .column, .columns { width: 100%; float: left; box-sizing: border-box; } @media (min-width: 400px) { .container { width: 85%; padding: 0; } } @media (min-width: 550px) { .container { width: 80%; } .column, .columns { margin-left: 4%; } .column:first-child, .columns:first-child { margin-left: 0; } .one.column, .one.columns { width: 4.66666666667%; } .two.columns { width: 13.3333333333%; } .three.columns { width: 22%; } .four.columns { width: 30.6666666667%; } .five.columns { width: 39.3333333333%; } .six.columns { width: 48%; } .seven.columns { width: 56.6666666667%; } .eight.columns { width: 65.3333333333%; } .nine.columns { width: 74.0%; } .ten.columns { width: 82.6666666667%; } .eleven.columns { width: 91.3333333333%; } .twelve.columns { width: 100%; margin-left: 0; } .one-third.column { width: 30.6666666667%; } .two-thirds.column { width: 65.3333333333%; } .one-half.column { width: 48%; } /* Offsets */ .offset-by-one.column, .offset-by-one.columns { margin-left: 8.66666666667%; } .offset-by-two.column, .offset-by-two.columns { margin-left: 17.3333333333%; } .offset-by-three.column, .offset-by-three.columns { margin-left: 26%; } .offset-by-four.column, .offset-by-four.columns { margin-left: 34.6666666667%; } .offset-by-five.column, .offset-by-five.columns { margin-left: 43.3333333333%; } .offset-by-six.column, .offset-by-six.columns { margin-left: 52%; } .offset-by-seven.column, .offset-by-seven.columns { margin-left: 60.6666666667%; } .offset-by-eight.column, .offset-by-eight.columns { margin-left: 69.3333333333%; } .offset-by-nine.column, .offset-by-nine.columns { margin-left: 78.0%; } .offset-by-ten.column, .offset-by-ten.columns { margin-left: 86.6666666667%; } .offset-by-eleven.column, .offset-by-eleven.columns { margin-left: 95.3333333333%; } .offset-by-one-third.column, .offset-by-one-third.columns { margin-left: 34.6666666667%; } .offset-by-two-thirds.column, .offset-by-two-thirds.columns { margin-left: 69.3333333333%; } .offset-by-one-half.column, .offset-by-one-half.columns { margin-left: 52%; } } html { font-size: 62.5%; } body { font-size: 1.5em; /* currently ems cause chrome bug misinterpreting rems on body element */ line-height: 1.6; font-weight: 400; font-family: "Raleway", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif; color: #222; } h1, h2, h3, h4, h5, h6 { margin-top: 0; margin-bottom: 2rem; font-weight: 300; } h1 { font-size: 3.6rem; line-height: 1.2; letter-spacing: -.1rem;} h2 { font-size: 3.4rem; line-height: 1.25; letter-spacing: -.1rem; } h3 { font-size: 3.2rem; line-height: 1.3; letter-spacing: -.1rem; } h4 { font-size: 2.8rem; line-height: 1.35; letter-spacing: -.08rem; } h5 { font-size: 2.4rem; line-height: 1.5; letter-spacing: -.05rem; } h6 { font-size: 1.5rem; line-height: 1.6; letter-spacing: 0; } p { margin-top: 0; } a { color: #1EAEDB; } a:hover { color: #0FA0CE; } .button, button, input[type="submit"], input[type="reset"], input[type="button"] { display: inline-block; height: 38px; padding: 0 30px; color: #555; text-align: center; font-size: 11px; font-weight: 600; line-height: 38px; letter-spacing: .1rem; text-transform: uppercase; text-decoration: none; white-space: nowrap; background-color: transparent; border-radius: 4px; border: 1px solid #bbb; cursor: pointer; box-sizing: border-box; } .button:hover, button:hover, input[type="submit"]:hover, input[type="reset"]:hover, input[type="button"]:hover, .button:focus, button:focus, input[type="submit"]:focus, input[type="reset"]:focus, input[type="button"]:focus { color: #333; border-color: #888; outline: 0; } .button.button-primary, button.button-primary, input[type="submit"].button-primary, input[type="reset"].button-primary, input[type="button"].button-primary { color: #FFF; background-color: #33C3F0; border-color: #33C3F0; } .button.button-primary:hover, button.button-primary:hover, input[type="submit"].button-primary:hover, input[type="reset"].button-primary:hover, input[type="button"].button-primary:hover, .button.button-primary:focus, button.button-primary:focus, input[type="submit"].button-primary:focus, input[type="reset"].button-primary:focus, input[type="button"].button-primary:focus { color: #FFF; background-color: #1EAEDB; border-color: #1EAEDB; } input[type="email"], input[type="number"], input[type="search"], input[type="text"], input[type="tel"], input[type="url"], input[type="password"], textarea, select { height: 38px; padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */ background-color: #fff; border: 1px solid #D1D1D1; border-radius: 4px; box-shadow: none; box-sizing: border-box; } /* Removes awkward default styles on some inputs for iOS */ input[type="email"], input[type="number"], input[type="search"], input[type="text"], input[type="tel"], input[type="url"], input[type="password"], textarea { -webkit-appearance: none; -moz-appearance: none; appearance: none; } textarea { min-height: 65px; padding-top: 6px; padding-bottom: 6px; } input[type="email"]:focus, input[type="number"]:focus, input[type="search"]:focus, input[type="text"]:focus, input[type="tel"]:focus, input[type="url"]:focus, input[type="password"]:focus, textarea:focus, select:focus { border: 1px solid #33C3F0; outline: 0; } label, legend { display: block; margin-bottom: .5rem; font-weight: 600; } fieldset { padding: 0; border-width: 0; } input[type="checkbox"], input[type="radio"] { display: inline; } label > .label-body { display: inline-block; margin-left: .5rem; font-weight: normal; } ul { list-style: circle; } ol { list-style: decimal; } ul ul, ul ol, ol ol, ol ul { margin: 1.5rem 0 1.5rem 3rem; font-size: 90%; } li > p {margin : 0;} th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #E1E1E1; } th:first-child, td:first-child { padding-left: 0; } th:last-child, td:last-child { padding-right: 0; } button, .button { margin-bottom: 1rem; } input, textarea, select, fieldset { margin-bottom: 1.5rem; } pre, blockquote, dl, figure, table, p, ul, ol, form { margin-bottom: 1.0rem; } .u-full-width { width: 100%; box-sizing: border-box; } .u-max-full-width { max-width: 100%; box-sizing: border-box; } .u-pull-right { float: right; } .u-pull-left { float: left; } hr { margin-top: 3rem; margin-bottom: 3.5rem; border-width: 0; border-top: 1px solid #E1E1E1; } .container:after, .row:after, .u-cf { content: ""; display: table; clear: both; } pre { display: block; padding: 9.5px; margin: 0 0 10px; font-size: 13px; line-height: 1.42857143; word-break: break-all; word-wrap: break-word; border: 1px solid #ccc; border-radius: 4px; } pre.hljl { margin: 0 0 10px; display: block; background: #f5f5f5; border-radius: 4px; padding : 5px; } pre.output { background: #ffffff; } pre.code { background: #ffffff; } pre.julia-error { color : red } code, kbd, pre, samp { font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 0.9em; } @media (min-width: 400px) {} @media (min-width: 550px) {} @media (min-width: 750px) {} @media (min-width: 1000px) {} @media (min-width: 1200px) {} h1.title {margin-top : 20px} img {max-width : 100%} div.title {text-align: center;} </style> </HEAD> <BODY> <div class ="container"> <div class = "row"> <div class = "col-md-12 twelve columns"> <div class=title > </div> <h2>Homework 4: Fourier Analysis</h2> <h2>Due date:</h2> <h3>Student Name:</h3> <p><strong>Exercise 1.</strong></p> <p>a.- Find the Fourier series of the function <span class=math >$f(x) := x$</span> in the interval <span class=math >$[-\pi,\pi]$</span>.</p> <p>b.- Use Parseval&#39;s relation to prove that </p> <p class=math >\[ \sum_{n=1}^{\infty} \frac{1}{n^2} = \pi^2/6 \]</p> <p><strong>Exercise 2.</strong></p> <p>a.- Find the Fourier series of the function <span class=math >$f(x):= e^{sx}$</span> in the interval <span class=math >$[-\pi, \pi]$</span>.</p> <p>b.- Use Parseval&#39;s relation to prove that </p> <p class=math >\[ \pi \mathrm{coth}(\pi s)/s = \sum_{n=-\infty}^{\infty} \frac{1}{s^2+n^2} \]</p> <p><strong>Exercise 3.</strong></p> <p>Let <span class=math >$S_n: L^2 \to L^2$</span> be the map that sends <span class=math >$f \in L^2$</span> to the partial Fourier series,</p> <p class=math >\[ S_n(f) := \sum_{m=-n}^{n} c_m e^{imx}, \;\;\;\;\;\;\; c_m:= \frac{1}{2\pi}\langle e^{imx},f(x) \rangle. \]</p> <p>Show that the <span class=math >$S_n$</span> are orthogonal projections and that <span class=math >$S_n S_m = S_m S_n = S_m$</span> if <span class=math >$m \leq n$</span>.</p> <p><strong>Exercise 4. Use of the Fourier Interpolation</strong></p> <p>Compute the Fourier Interpolation of the functions: <span class=math >$|x|$</span>, <span class=math >$sign(x)$</span>, and <span class=math >$sin(x)+ 3cos(x)$</span> and <span class=math >$e^{sx}$</span> &#40;for <span class=math >$s= 1, 3, 3i$</span>&#41; and plot it along the Fourier series coefficients. Below is an example:</p> <pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Pkg</span><span class='hljl-t'>
</span><span class='hljl-n'>Pkg</span><span class='hljl-oB'>.</span><span class='hljl-nf'>instantiate</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>FFTW</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Plots</span>
</pre> <pre class='hljl'>
<span class='hljl-n'>N</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>64</span><span class='hljl-t'>
</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'>
</span><span class='hljl-cs'>#f(x) = x*sign(x)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#f(x) = exp(2*x)</span><span class='hljl-t'>
</span><span class='hljl-n'>xi</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>π</span><span class='hljl-t'>
</span><span class='hljl-n'>xf</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>π</span><span class='hljl-t'>
</span><span class='hljl-n'>xv</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-n'>xi</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>xf</span><span class='hljl-oB'>-</span><span class='hljl-n'>xi</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>N</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>N</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>fv</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>,</span><span class='hljl-n'>fv</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;f(x)=x&quot;</span><span class='hljl-p'>)</span>
</pre> <p>The Fourier coefficients of <span class=math >$f(x)=x$</span> in the interval <span class=math >$[-π,π]$</span> are <span class=math >$b_n=i/n$</span>, <span class=math >$n\neq 0$</span>, <span class=math >$b_0 = 0$</span>. While the Fourier Interpolant is: <span class=math >$i_n = 1/(e^{-i2πn}-1)$</span>. </p> <pre class='hljl'>
<span class='hljl-n'>freq</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>fftshift</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfftfreq</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>))</span><span class='hljl-oB'>*</span><span class='hljl-n'>N</span><span class='hljl-t'>
</span><span class='hljl-n'>rft</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>fv</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#fftf = fft(fv)</span><span class='hljl-t'>
</span><span class='hljl-n'>bn</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-n'>freq</span><span class='hljl-t'>  </span><span class='hljl-cs'>#for f(x)=x</span><span class='hljl-t'>
</span><span class='hljl-n'>an</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>freq</span><span class='hljl-oB'>.^</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>N</span><span class='hljl-oB'>/</span><span class='hljl-n'>π</span><span class='hljl-oB'>*</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-cs'>#for f(x)=x*sign(x)</span><span class='hljl-t'>
</span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-oB'>*</span><span class='hljl-n'>π</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-p'>(</span><span class='hljl-t'> </span><span class='hljl-n'>exp</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>im</span><span class='hljl-oB'>*</span><span class='hljl-ni'>2</span><span class='hljl-oB'>*</span><span class='hljl-n'>π</span><span class='hljl-oB'>*</span><span class='hljl-n'>freq</span><span class='hljl-oB'>/</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>.-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter</span><span class='hljl-p'>(</span><span class='hljl-n'>freq</span><span class='hljl-p'>,</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>rft</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;real&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>markersize</span><span class='hljl-oB'>=</span><span class='hljl-ni'>4</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>freq</span><span class='hljl-p'>,</span><span class='hljl-n'>imag</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>rft</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;imag&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>freq</span><span class='hljl-p'>,</span><span class='hljl-n'>bn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;1/n&quot;</span><span class='hljl-t'> </span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#scatter!(freq,an, label=&quot;2N/π/n^2&quot;)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>freq</span><span class='hljl-p'>,</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-kp'>in</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;real_fi&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>markersize</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>freq</span><span class='hljl-p'>,</span><span class='hljl-n'>imag</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-kp'>in</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;imag_fi&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>markersize</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span>
</pre> <h3>For future use we construct an Fourier interpolant for functions in &#91;0,2π&#93;</h3> <pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sign</span><span class='hljl-p'>(</span><span class='hljl-nf'>mod</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-n'>π</span><span class='hljl-p'>)</span><span class='hljl-oB'>-</span><span class='hljl-n'>π</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'>#it works fine with this, except at zero (because of periodicity issues)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#f(x) = -(x*(1-sign(x-π)) + (x-2π)*(sign(x-π)+1)) /2/π #it does not work with this.</span><span class='hljl-t'>
</span><span class='hljl-cs'>#f(x) = sin(x) + sin(3*x)/3 + sin(5*x)/5 #it works fine with this.</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>π</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;f(x)&quot;</span><span class='hljl-p'>)</span>
</pre> <pre class='hljl'>
<span class='hljl-s'>&quot;&quot;&quot;
    fourier_interpolant(f::Vector, T=2π)

Compute the Fourier interpolant `P(x)` of a periodic signal sampled uniformly over [0, T).

# Arguments
- `f`: Vector of function values `[f₁, f₂, ..., f_N]` sampled at `xₙ = (n-1) * T/N`.
- `T`: Period of the signal (default: `2π`).

# Returns
- A function `P(x)` that evaluates the Fourier interpolant at any `x`.
&quot;&quot;&quot;</span><span class='hljl-t'>
</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>fourier_interpolant</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>Vector</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-n'>π</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>N</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>Δx</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-t'>
    
    </span><span class='hljl-cs'># Compute normalized DFT coefficients</span><span class='hljl-t'>
    </span><span class='hljl-n'>F</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>fft</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-t'>
    
    </span><span class='hljl-cs'># Frequencies in FFT order (0, 1, ..., N/2, -N/2+1, ..., -1)</span><span class='hljl-t'>
    </span><span class='hljl-n'>k</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>fftfreq</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-t'>  </span><span class='hljl-cs'># Integer frequencies</span><span class='hljl-t'>
    
    </span><span class='hljl-cs'># Precompute coefficients for the interpolant</span><span class='hljl-t'>
    </span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>P</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-cs'># Map x to [0, T) for periodicity</span><span class='hljl-t'>
        </span><span class='hljl-n'>x_mod</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-cs'># Sum over all frequency components</span><span class='hljl-t'>
        </span><span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-n'>F</span><span class='hljl-p'>[</span><span class='hljl-n'>m</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-n'>π</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>im</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>k</span><span class='hljl-p'>[</span><span class='hljl-n'>m</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>x_mod</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-oB'>:</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>|&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>real</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-n'>P</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class='hljl'>
<span class='hljl-n'>N</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>32</span><span class='hljl-t'>
</span><span class='hljl-n'>T</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>π</span><span class='hljl-t'>
</span><span class='hljl-nf'>ff</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-n'>sin</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-ni'>5</span><span class='hljl-oB'>*</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x_sampled</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>π</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>N</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-cs'># Sample over [0, 2π)</span><span class='hljl-t'>
</span><span class='hljl-n'>f_sampled</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ff</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>x_sampled</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-cs'># Sampled function values</span><span class='hljl-t'>

</span><span class='hljl-n'>P</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>fourier_interpolant</span><span class='hljl-p'>(</span><span class='hljl-n'>f_sampled</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x_eval</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>π</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-n'>π</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1000</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-cs'># Test periodicity</span><span class='hljl-t'>
</span><span class='hljl-n'>P_eval</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>P</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>x_eval</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>x_eval</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P_eval</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Fourier Interpolant (N=</span><span class='hljl-si'>$N</span><span class='hljl-s'>)&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>x_eval</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ff</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>x_eval</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;True f(x)&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linestyle</span><span class='hljl-oB'>=:</span><span class='hljl-n'>dash</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>x_sampled</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f_sampled</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Sampled Points&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>red</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>title!</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;Fourier Interpolation&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>xlabel!</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;x&quot;</span><span class='hljl-p'>)</span>
</pre> <pre class='hljl'>
<span class='hljl-n'>f_sampled</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>x_sampled</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>P</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>fourier_interpolant_1</span><span class='hljl-p'>(</span><span class='hljl-n'>f_sampled</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>P_eval</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>P</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>x_eval</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>x_eval</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P_eval</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Fourier Interpolant (N=</span><span class='hljl-si'>$N</span><span class='hljl-s'>)&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>x_eval</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>x_eval</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Exact function&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linestyle</span><span class='hljl-oB'>=:</span><span class='hljl-n'>dash</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>x_sampled</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f_sampled</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Sampled Points&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>red</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>title!</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;Fourier Interpolation&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>xlabel!</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;x&quot;</span><span class='hljl-p'>)</span>
</pre> <p><strong>Exercise 5. Use of the Fourier Interpolation</strong></p> <p>Play around and interpolate different functions with the tool just introduced.</p> <h3>The Fourier Interpolant of a delta function.</h3> <p>We approximate a delta function distribution by a sequence of continuous functions;</p> <p class=math >\[ f(x,x_0,n) = \left(\begin{align} (x-x_0-1/n*n &\;\; x \in [x_0-1/n,x_0] \nonumber\\ (x_0+1/n-x)*n &\;\; x \in [x_0,x_0+1/n] \nonumber\\ 0 &\;\; x \notin [x_0-1/n,x_0+1/n] \nonumber \end{align} \right. \]</p> <pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>&amp;&amp;</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;=</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-t'>
        </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>x0</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-n'>n</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
    </span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-t'> </span><span class='hljl-oB'>&amp;&amp;</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-t'>
        </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>x0</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-n'>n</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
    </span><span class='hljl-k'>else</span><span class='hljl-t'>
        </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class='hljl'>
<span class='hljl-n'>x0</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>
</span><span class='hljl-nf'>f1</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>f2</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>f3</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>f6</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>6</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>f9</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>9</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>f18</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f_n</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-ni'>18</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;f_1(x)&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>f2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;f_2(x)&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>f3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;f_3(x)&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-sb'>```The real parts get higher and higher frequency components. ```</span><span class='hljl-nf'>juliascatter</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f1</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_1(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f1</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_1(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#scatter!(real.(rfft(f2.(xv))), label=&quot;Ff_2(x)&quot;)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f2</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_2(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_3(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>  
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_3(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f6</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_6(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f6</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_6(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f9</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_9(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f9</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_9(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f18</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_18(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f18</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_18(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>real</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f1</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_1(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-sb'>```The imaginary parts are all very small.```</span><span class='hljl-nf'>juliascatter</span><span class='hljl-p'>(</span><span class='hljl-n'>imag</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f1</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_1(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#scatter!(imag.(rfft(f2.(xv))), label=&quot;Ff_2(x)&quot;)    </span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>imag</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_3(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>imag</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f6</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_6(x)&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>imag</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-nf'>rfft</span><span class='hljl-p'>(</span><span class='hljl-n'>f9</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xv</span><span class='hljl-p'>))),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;Ff_9(x)&quot;</span><span class='hljl-p'>)</span>
</pre> <p><strong>Exercise 6. Interpolation of distributions</strong></p> <p>Try to deduce what is the limiting interpolant. Not only for the case of <span class=math >$x_0=0$</span>, but in general. Then compare with the exact value for it. </p> <HR/> <div class=footer > <p> Published from <a href=Fourier.jmd >Fourier.jmd</a> using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.12 on 2025-05-07. </p> </div> </div> </div> </div> </BODY> </HTML>