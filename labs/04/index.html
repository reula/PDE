<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/PDE/css/franklin.css"> <link rel=stylesheet  href="/PDE/css/tufte.css"> <link rel=stylesheet  href="/PDE/css/latex.css"> <link rel=stylesheet  href="/PDE/css/adjust.css"> <link rel=stylesheet  href="/PDE/css/bibliography.css"> <link rel=icon  href="/PDE/assets/favicon.png"> <link rel=stylesheet  href="/PDE/css/weave.css"> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}, TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <title>Boundary conditions using SAT</title> <div id=layout > <div id=menu > <ul> <li><a style="font-size:larger;" href="/PDE/">Home</a> <li><a style="font-size:larger;" href="/PDE/schedule/">Schedule</a> <li><a style="font-size:larger;" href="/PDE/homework/">Homework</a> <li><a style="font-size:larger;" href="/PDE/labs/">Labs</a> <li><a style="font-size:larger;" href="/PDE/notes/">Notes</a> <li><a style="font-size:larger;" href="/PDE/bibliography/">Bibliography</a> </ul> </div> <div id=main > <div class=franklin-content > <!DOCTYPE html> <html lang=en > <meta charset=UTF-8 > <title></title> <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/PDE/css/franklin.css"> <link rel=stylesheet  href="/PDE/css/tufte.css"> <link rel=stylesheet  href="/PDE/css/adjust.css"> <link rel=stylesheet  href="/PDE/css/latex.css"> <link rel=stylesheet  href="/PDE/css/weave.css"> <style> </style> <script> window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }, svg: { fontCache: 'global' } }; </script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" async></script> <div class=franklin-content > <h1>Assignment 3</h1> <p><strong>Authors:</strong> Joaquín Pelle, Oscar Reula, Pablo Montes</p> <h5><a href="/PDE/weave/lab04/lab4.ipynb">Click here to download this notebook</a></h5> <h3>Important 1:</h3> <p>This notebook is designed to run on Julia 1.6 or later.</p> <h3>Important 2:</h3> <p>Rename the file as: <strong>name<em>assignment</em>3.ipynb</strong></p> <p><strong>All generated code and the presentation must be included in this notebook.</strong></p> <p><strong>The objectives of this assignment are as follows:</strong></p> <ol> <li><p>To understand wave propagation and relate it to the need to impose boundary conditions according to the direction of propagation.</p> <li><p>To comprehend the scheme of imposing boundary conditions using finite difference operators with the Summation By Parts property.</p> </ol> <hr /> <p><strong>1&#41;</strong> In the directory, you will find a Julia notebook that allows you to evolve the advection equation by providing a boundary condition at the edge where the solution enters the integration region. Try different initial and boundary conditions. What happens if you change the sign of the velocity?</p> <p><strong>2&#41;</strong> Note that the convergence of the method, in the <span class=math >$L^2$</span> norm, is of second order, even though the approximation at the boundary is first order.</p> <p><strong>3&#41;</strong> The fourth order Summation By Parts finite difference operator has the following matrix entries near <span class=math >$1$</span> and <span class=math >$N$</span>:</p> <pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>LinearAlgebra</span><span class='hljl-t'>
</span><span class='hljl-n'>Head</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
   </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.4117647059</span><span class='hljl-t'>   </span><span class='hljl-nfB'>1.7352941176</span><span class='hljl-t'>  </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.2352941176</span><span class='hljl-t'>  </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.0882352941</span><span class='hljl-t'>   </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>           </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>
   </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.5</span><span class='hljl-t'>            </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>            </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'>            </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>            </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>           </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>
    </span><span class='hljl-nfB'>0.0930232558</span><span class='hljl-t'>  </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.6860465116</span><span class='hljl-t'>   </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>            </span><span class='hljl-nfB'>0.6860465116</span><span class='hljl-t'>  </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.0930232558</span><span class='hljl-t'>  </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>
    </span><span class='hljl-nfB'>0.0306122449</span><span class='hljl-t'>   </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>           </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.6020408163</span><span class='hljl-t'>   </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>            </span><span class='hljl-nfB'>0.6530612245</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.0816326531</span><span class='hljl-t'>
</span><span class='hljl-p'>]</span>
</pre> <pre class=output >
4×6 Matrix&#123;Float64&#125;:
 -1.41176     1.73529   -0.235294  -0.0882353   0.0         0.0
 -0.5         0.0        0.5        0.0         0.0         0.0
  0.0930233  -0.686047   0.0        0.686047   -0.0930233   0.0
  0.0306122   0.0       -0.602041   0.0         0.653061   -0.0816327
</pre> <p>Plus a standard band matrix part with bandwidth 5. Note that the bottom part of the matrix is not the same as the Head, but instead corresponds to an appropriate transposition and sign change of it.</p> <pre class='hljl'>
<span class='hljl-p'>[</span><span class='hljl-nfB'>0.6666666666666</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.0833333333333</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0833333333333</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.6666666666666</span><span class='hljl-p'>]</span>
</pre> <pre class=output >
1×5 Matrix&#123;Float64&#125;:
 0.666667  -0.0833333  0.0  0.0833333  0.666667
</pre> <p>On the other hand, the inner product is given by:</p> <pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>h4</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ones</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-cs'># Set specialized values at the boundaries</span><span class='hljl-t'>
    </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>17</span><span class='hljl-oB'>/</span><span class='hljl-ni'>48</span><span class='hljl-t'>
    </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>59</span><span class='hljl-oB'>/</span><span class='hljl-ni'>48</span><span class='hljl-t'>
    </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>43</span><span class='hljl-oB'>/</span><span class='hljl-ni'>48</span><span class='hljl-t'>
    </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-ni'>4</span><span class='hljl-p'>]</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>49</span><span class='hljl-oB'>/</span><span class='hljl-ni'>48</span><span class='hljl-t'>
    </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-k'>end</span><span class='hljl-p'>]</span><span class='hljl-t'>     </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-k'>end</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-k'>end</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-k'>end</span><span class='hljl-oB'>-</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-p'>[</span><span class='hljl-ni'>4</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-nf'>Diagonal</span><span class='hljl-p'>(</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-nf'>h4</span><span class='hljl-p'>(</span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span>
</pre> <pre class=output >
10×10 Diagonal&#123;Float64, Vector&#123;Float64&#125;&#125;:
 0.354167   ⋅        ⋅         ⋅        ⋅   …   ⋅         ⋅        ⋅ 
  ⋅        1.22917   ⋅         ⋅        ⋅       ⋅         ⋅        ⋅ 
  ⋅         ⋅       0.895833   ⋅        ⋅       ⋅         ⋅        ⋅ 
  ⋅         ⋅        ⋅        1.02083   ⋅       ⋅         ⋅        ⋅ 
  ⋅         ⋅        ⋅         ⋅       1.0      ⋅         ⋅        ⋅ 
  ⋅         ⋅        ⋅         ⋅        ⋅   …   ⋅         ⋅        ⋅ 
  ⋅         ⋅        ⋅         ⋅        ⋅       ⋅         ⋅        ⋅ 
  ⋅         ⋅        ⋅         ⋅        ⋅      0.895833   ⋅        ⋅ 
  ⋅         ⋅        ⋅         ⋅        ⋅       ⋅        1.22917   ⋅ 
  ⋅         ⋅        ⋅         ⋅        ⋅       ⋅         ⋅       0.354167
</pre> <p>Construct the fourth-order operator and verify that it converges with order 4 in the <span class=math >$L^2$</span> norm &#40;even though near the boundary the convergence drops to second order&#41;. Also, verify that it satisfies the Summation By Parts &#40;SBP&#41; property.</p> <p><strong>4&#41;</strong> Now consider the wave equation, <span class=math >$\phi_{tt} = c^2 \phi_{xx}$</span>. Decompose it into a first-order system with one mode propagating to the left and one to the right. <strong>Hint:</strong> Determine what equation is satisfied by the combination <span class=math >$V_+ := \phi_t - c\phi_x$</span>. Use this decomposition to specify boundary conditions so that the problem is well-posed &#40;but not overdetermined&#41;. Consider the following cases:</p> <ol> <li><p>Homogeneous boundary conditions: nothing enters, but the initial data is nonzero.</p> <li><p>Reflecting boundary conditions: whatever arrives as one mode enters as the other. To impose this condition, choose the combination of modes at the boundary so that <span class=math >$\phi$</span> remains constant in time.</p> </ol> <p><strong>5&#41;</strong> <strong>For the adventurous:</strong> Consider two adjacent regions, <span class=math >$L_L$</span> and <span class=math >$L_R$</span>, in which the wave equation evolves but with different speeds <span class=math >$(c_L, c_R)$</span> &#40;imagine that the regions are strings made of different materials or densities&#41;. Treat the interface between the media as a place where boundary conditions are specified according to what comes from the other region. Choose these conditions so that <span class=math >$\phi_t$</span> and <span class=math >$\phi_x$</span> are continuous across the interface. Implement code that reflects the situation described. </p> <ul> <li><p>Implement boundary conditions on the left side of <span class=math >$L_R$</span> so that a sinusoidal wave enters. </p> <li><p>Implement boundary conditions on the right side of <span class=math >$L_L$</span> so that the outgoing wave is reflected and becomes incoming.</p> </ul> <p>An example of what you should achieve &#40;the scale of the waves is off, focus on there being a reflection and a transmission&#41;:</p> <p><img src="ropes_anim_fps20.gif &quot;Example&quot;" alt=Ropes  /></p> <footer> <p> Published from <a href=lab4.ipynb >lab4.ipynb</a> using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.12 on 2025-05-29. </p> </footer> </div> <div class=back-to-top > <span><a href="#" title="Back to Top"><i class="fa fa-chevron-circle-up"></i></a></span> </div> </div> </div> </div>