<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/PDE/css/franklin.css"> <link rel=stylesheet  href="/PDE/css/tufte.css"> <link rel=stylesheet  href="/PDE/css/latex.css"> <link rel=stylesheet  href="/PDE/css/adjust.css"> <link rel=stylesheet  href="/PDE/css/bibliography.css"> <link rel=icon  href="/PDE/assets/favicon.png"> <link rel=stylesheet  href="/PDE/css/weave.css"> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}, TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <title>Conservative methods</title> <div id=layout > <div id=menu > <ul> <li><a style="font-size:larger;" href="/PDE/">Home</a> <li><a style="font-size:larger;" href="/PDE/schedule/">Schedule</a> <li><a style="font-size:larger;" href="/PDE/homework/">Homework</a> <li><a style="font-size:larger;" href="/PDE/labs/">Labs</a> <li><a style="font-size:larger;" href="/PDE/notes/">Notes</a> <li><a style="font-size:larger;" href="/PDE/bibliography/">Bibliography</a> </ul> </div> <div id=main > <div class=franklin-content > <!DOCTYPE html> <html lang=en > <meta charset=UTF-8 > <title></title> <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/PDE/css/franklin.css"> <link rel=stylesheet  href="/PDE/css/tufte.css"> <link rel=stylesheet  href="/PDE/css/adjust.css"> <link rel=stylesheet  href="/PDE/css/latex.css"> <link rel=stylesheet  href="/PDE/css/weave.css"> <style> </style> <script> window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }, svg: { fontCache: 'global' } }; </script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" async></script> <div class=franklin-content > <h1>Conservative Methods</h1> <p>We solve the Burgers equation &#40;and the advection equation&#41; using the KT2 &#40;second-order Kurganov-Tadmor&#41;, MP5 &#40;5th-order monotonicity preserving&#41;, and WENOZ methods.</p> <pre class='hljl'>
<span class='hljl-cs'>#using DiffEqOperators</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>OrdinaryDiffEq</span><span class='hljl-t'>
</span><span class='hljl-cs'>#using DifferentialEquations</span>
</pre> <pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Plots</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Printf</span>
</pre> <p>Here, we decide which equation to solve. This will be used later when choosing the <code>Flux_x&#33;</code> function.</p> <pre class='hljl'>
<span class='hljl-cs'>#problem = :advection</span><span class='hljl-t'>
</span><span class='hljl-n'>problem</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:burgers</span>
</pre> <pre class=output >
:burgers
</pre> <p>We define the numerical implementations of the methods along with some auxiliary functions</p> <pre class='hljl'>
<span class='hljl-nd'>@inline</span><span class='hljl-t'> </span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>1.0</span><span class='hljl-oB'>.*</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>.&gt;</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>)</span><span class='hljl-oB'>.*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>.&lt;</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-nd'>@inline</span><span class='hljl-t'> </span><span class='hljl-nf'>minmod</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-p'>))</span><span class='hljl-oB'>*</span><span class='hljl-nf'>min</span><span class='hljl-p'>(</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nd'>@inline</span><span class='hljl-t'> </span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>minmod</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>sgnbc</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>mysign_zero</span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-cs'>#2 if both are positive, -2 if both are negative, 0 otherwise</span><span class='hljl-t'>
    </span><span class='hljl-n'>sgnac</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>mysign_zero</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-cs'>#2 if both are positive, -2 if both are negative, 0 otherwise</span><span class='hljl-t'>
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.25</span><span class='hljl-oB'>*</span><span class='hljl-n'>sgnbc</span><span class='hljl-oB'>*</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>sgnac</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-nf'>min</span><span class='hljl-p'>(</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-p'>),</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-nd'>@inline</span><span class='hljl-t'> </span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>minmod</span><span class='hljl-p'>(</span><span class='hljl-n'>w</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>z</span><span class='hljl-p'>)</span><span class='hljl-t'> 
    </span><span class='hljl-nfB'>0.125</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>w</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>))</span><span class='hljl-oB'>*</span><span class='hljl-nf'>abs</span><span class='hljl-p'>((</span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>w</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-p'>))</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>w</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-nf'>mysign</span><span class='hljl-p'>(</span><span class='hljl-n'>z</span><span class='hljl-p'>)))</span><span class='hljl-oB'>*</span><span class='hljl-nf'>min</span><span class='hljl-p'>(</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>w</span><span class='hljl-p'>),</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-p'>),</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>z</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>


</span><span class='hljl-cs'>#Kurganov-Tadmor method</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>KT!</span><span class='hljl-p'>(</span><span class='hljl-n'>dfields</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>eqpars</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-oB'>::</span><span class='hljl-n'>Float64</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>θ</span><span class='hljl-oB'>::</span><span class='hljl-n'>Float64</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Fx!</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>MaxSpeed</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-oB'>::</span><span class='hljl-n'>Int64</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_FIELDS</span><span class='hljl-oB'>::</span><span class='hljl-n'>Int32</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>auxvectors</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>par</span><span class='hljl-t'>
    </span><span class='hljl-n'>Dm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>D</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Dp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u_mm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u_mp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u_pm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u_pp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_mm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_mp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_pm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_pp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>H_m</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>H_p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>auxvectors</span><span class='hljl-t'>

    </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>idx</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>N</span><span class='hljl-t'>
        </span><span class='hljl-n'>idxll</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(((</span><span class='hljl-n'>idx</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>idxl</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(((</span><span class='hljl-n'>idx</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>idxr</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(((</span><span class='hljl-n'>idx</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>idxrr</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(((</span><span class='hljl-n'>idx</span><span class='hljl-oB'>+</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        
        </span><span class='hljl-n'>fll</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idxll</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>fl</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idxl</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>f</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idx</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>fr</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idxr</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>frr</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idxrr</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>Dm</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>minmod</span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>fll</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>θ</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>-</span><span class='hljl-n'>fl</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>θ</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>fl</span><span class='hljl-oB'>-</span><span class='hljl-n'>fll</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-cs'># * h</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>D</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>minmod</span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>fr</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>fl</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>θ</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>fr</span><span class='hljl-oB'>-</span><span class='hljl-n'>f</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>θ</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>-</span><span class='hljl-n'>fl</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-cs'># * h</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>Dp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>minmod</span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>frr</span><span class='hljl-oB'>-</span><span class='hljl-n'>f</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>θ</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>frr</span><span class='hljl-oB'>-</span><span class='hljl-n'>fr</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>θ</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>fr</span><span class='hljl-oB'>-</span><span class='hljl-n'>f</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-cs'># * h</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>u_mm</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>fl</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-n'>Dm</span><span class='hljl-t'>  </span><span class='hljl-cs'>#/h</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>u_mp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-n'>D</span><span class='hljl-t'> </span><span class='hljl-cs'>#/h</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>u_pm</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-n'>D</span><span class='hljl-t'> </span><span class='hljl-cs'>#/h</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>u_pp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>fr</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-n'>Dp</span><span class='hljl-t'> </span><span class='hljl-cs'>#/h</span><span class='hljl-t'>
        
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_mm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u_mm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>eqpars</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_mp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u_mp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>eqpars</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_pm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u_pm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>eqpars</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_pp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u_pp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>eqpars</span><span class='hljl-p'>)</span><span class='hljl-t'>
        
        
        </span><span class='hljl-n'>a_m</span><span class='hljl-oB'>::</span><span class='hljl-n'>Float64</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>max</span><span class='hljl-p'>(</span><span class='hljl-nf'>MaxSpeed</span><span class='hljl-p'>(</span><span class='hljl-n'>u_mm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>eqpars</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>MaxSpeed</span><span class='hljl-p'>(</span><span class='hljl-n'>u_mp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>eqpars</span><span class='hljl-p'>))</span><span class='hljl-t'>       
        </span><span class='hljl-n'>a_p</span><span class='hljl-oB'>::</span><span class='hljl-n'>Float64</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>max</span><span class='hljl-p'>(</span><span class='hljl-nf'>MaxSpeed</span><span class='hljl-p'>(</span><span class='hljl-n'>u_pm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>eqpars</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>MaxSpeed</span><span class='hljl-p'>(</span><span class='hljl-n'>u_pp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>eqpars</span><span class='hljl-p'>))</span><span class='hljl-t'>        

        
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>H_m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_mp</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>F_mm</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>a_m</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>u_mp</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>u_mm</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>H_p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_pp</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>F_pm</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>a_p</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>u_pp</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>u_pm</span><span class='hljl-p'>)</span><span class='hljl-t'>
        
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>dfields</span><span class='hljl-p'>[</span><span class='hljl-n'>idx</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>h</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>H_p</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>H_m</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>createKTauxvectors</span><span class='hljl-p'>(</span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>D</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Array</span><span class='hljl-p'>{</span><span class='hljl-n'>Float64</span><span class='hljl-p'>}(</span><span class='hljl-n'>undef</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>Dm</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>Dp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>umm</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>ump</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>upm</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>upp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>Fmm</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>Fmp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>Fpm</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>Fpp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>Hm</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>Hp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>D</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>Dm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>D</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Dp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>umm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ump</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>upm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>upp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Fmm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Fmp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Fpm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Fpp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Hm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Hp</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>



</span><span class='hljl-cm'>#==================================MP5=====================================#</span><span class='hljl-t'>

</span><span class='hljl-cs'>#Reconstruction</span><span class='hljl-t'>
</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>MP5reconstruction!</span><span class='hljl-p'>(</span><span class='hljl-n'>Vl</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Vjmm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Vjm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Vj</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Vjp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Vjpp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_Fields</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>B1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0166666666666666667</span><span class='hljl-t'>  </span><span class='hljl-cs'>#1/60</span><span class='hljl-t'>
    </span><span class='hljl-n'>B2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.3333333333333333333</span><span class='hljl-t'>  </span><span class='hljl-cs'>#4/3</span><span class='hljl-t'>
    </span><span class='hljl-n'>eps</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1e-10</span><span class='hljl-t'>
    </span><span class='hljl-n'>ALPHA</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>4.0</span><span class='hljl-t'>
    </span><span class='hljl-cm'>#=Vjmm = V[1]
    Vjm = V[2]
    Vj = V[3]
    Vjp = V[4]
    Vjpp = V[5]=#</span><span class='hljl-t'>
    </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>N_Fields</span><span class='hljl-t'>
        </span><span class='hljl-n'>Vor</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>B1</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-nfB'>2.0</span><span class='hljl-oB'>*</span><span class='hljl-n'>Vjmm</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nfB'>13.0</span><span class='hljl-oB'>*</span><span class='hljl-n'>Vjm</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nfB'>47.0</span><span class='hljl-oB'>*</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>27</span><span class='hljl-oB'>*</span><span class='hljl-n'>Vjp</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nfB'>3.0</span><span class='hljl-oB'>*</span><span class='hljl-n'>Vjpp</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'> </span><span class='hljl-cm'>#=This is the original interpolation.
                                                                       All that follows is the application of 
                                                                       limiters to treat shocks=#</span><span class='hljl-t'>
        </span><span class='hljl-n'>Vmp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>minmod</span><span class='hljl-p'>(</span><span class='hljl-n'>Vjp</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>ALPHA</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>Vjm</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]))</span><span class='hljl-t'>  </span><span class='hljl-cs'>#mp = monotonicity preserving. It&#39;s the median between v_j, v_(j+1)</span><span class='hljl-t'>
                                                  </span><span class='hljl-cs'>#and an upper limit v^UL = v_j+ALPHA(v_j-v_(j-1))</span><span class='hljl-t'>
        </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-p'>((</span><span class='hljl-n'>Vor</span><span class='hljl-oB'>-</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>Vor</span><span class='hljl-oB'>-</span><span class='hljl-n'>Vmp</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;</span><span class='hljl-t'> </span><span class='hljl-n'>eps</span><span class='hljl-t'>             </span><span class='hljl-cs'>#this condition is equivalent to asking vl in [vj, v^{MP}]</span><span class='hljl-t'>
            </span><span class='hljl-n'>Vl</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Vor</span><span class='hljl-t'> </span><span class='hljl-cs'>#vl = v^{L}_{j+1/2}</span><span class='hljl-t'>
        </span><span class='hljl-k'>else</span><span class='hljl-t'>
            </span><span class='hljl-n'>djm1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Vjmm</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nfB'>2.0</span><span class='hljl-oB'>*</span><span class='hljl-n'>Vjm</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
            </span><span class='hljl-n'>dj</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Vjm</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-oB'>*</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>Vjp</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
            </span><span class='hljl-n'>djp1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nfB'>2.0</span><span class='hljl-oB'>*</span><span class='hljl-n'>Vjp</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>Vjpp</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
            </span><span class='hljl-n'>dm4jph</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>minmod</span><span class='hljl-p'>(</span><span class='hljl-ni'>4</span><span class='hljl-oB'>*</span><span class='hljl-n'>dj</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>djp1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-oB'>*</span><span class='hljl-n'>djp1</span><span class='hljl-oB'>-</span><span class='hljl-n'>dj</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dj</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>djp1</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-cs'>#ph = plus half (+1/2)</span><span class='hljl-t'>
            </span><span class='hljl-n'>dm4jmh</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>minmod</span><span class='hljl-p'>(</span><span class='hljl-ni'>4</span><span class='hljl-oB'>*</span><span class='hljl-n'>dj</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>djm1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-oB'>*</span><span class='hljl-n'>djm1</span><span class='hljl-oB'>-</span><span class='hljl-n'>dj</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dj</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>djm1</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-cs'>#mh = minus half (-1/2)</span><span class='hljl-t'>
            </span><span class='hljl-cs'>#d^{M4}_{j+1/2} = \minmod(4d_{j}-d_{j+1},4d_{j+1}-d_{j}, d_{j}, d_{j+1})</span><span class='hljl-t'>
            </span><span class='hljl-n'>Vul</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>ALPHA</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>Vjm</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'>   </span><span class='hljl-cs'>#upper limit</span><span class='hljl-t'>
            </span><span class='hljl-n'>Vav</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>Vjp</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'>          </span><span class='hljl-cs'>#average</span><span class='hljl-t'>
            </span><span class='hljl-n'>Vmd</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Vav</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-n'>dm4jph</span><span class='hljl-t'>        </span><span class='hljl-cs'>#Vmedian</span><span class='hljl-t'>
            </span><span class='hljl-n'>Vlc</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>Vjm</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>B2</span><span class='hljl-oB'>*</span><span class='hljl-n'>dm4jmh</span><span class='hljl-t'>
            </span><span class='hljl-n'>Vmin</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>max</span><span class='hljl-p'>(</span><span class='hljl-nf'>min</span><span class='hljl-p'>(</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>Vjp</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>Vmd</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>min</span><span class='hljl-p'>(</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>Vul</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Vlc</span><span class='hljl-p'>));</span><span class='hljl-t'>
            </span><span class='hljl-n'>Vmax</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>min</span><span class='hljl-p'>(</span><span class='hljl-nf'>max</span><span class='hljl-p'>(</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>Vjp</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>Vmd</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>max</span><span class='hljl-p'>(</span><span class='hljl-n'>Vj</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>Vul</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Vlc</span><span class='hljl-p'>));</span><span class='hljl-t'>
            </span><span class='hljl-n'>Vl</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Vor</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>minmod</span><span class='hljl-p'>(</span><span class='hljl-n'>Vmin</span><span class='hljl-oB'>-</span><span class='hljl-n'>Vor</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Vmax</span><span class='hljl-oB'>-</span><span class='hljl-n'>Vor</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'>#this places Vor between Vmin and Vmax</span><span class='hljl-t'>
        </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'> 

</span><span class='hljl-cs'>#MP5 implementation with Lax Flux Splitting</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>mp5!</span><span class='hljl-p'>(</span><span class='hljl-n'>dfields</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'># j is the grid position</span><span class='hljl-t'>
    </span><span class='hljl-cs'># we assume u unidimensional</span><span class='hljl-t'>
    </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_Fields</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Fx!</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Speed_max</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>auxvectors</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>par</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Mm3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mm2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mm1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_M</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pp1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pp2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pp3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_LP</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_LM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_RP</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_RM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>H_m</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>H_p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>auxvectors</span><span class='hljl-t'>
    

    </span><span class='hljl-cs'>#note: we use f for fields and F for fluxes.</span><span class='hljl-t'>
    
    </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>idx</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>N</span><span class='hljl-t'>
        </span><span class='hljl-cs'>#first we defined shifted indices</span><span class='hljl-t'>
        </span><span class='hljl-n'>idxm3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(((</span><span class='hljl-n'>idx</span><span class='hljl-oB'>-</span><span class='hljl-ni'>3</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>idxm2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(((</span><span class='hljl-n'>idx</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>idxm1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(((</span><span class='hljl-n'>idx</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>idxp1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(((</span><span class='hljl-n'>idx</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>idxp2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(((</span><span class='hljl-n'>idx</span><span class='hljl-oB'>+</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>idxp3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>mod</span><span class='hljl-p'>(((</span><span class='hljl-n'>idx</span><span class='hljl-oB'>+</span><span class='hljl-ni'>3</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        
    
        </span><span class='hljl-n'>um3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idxm3</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>um2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idxm2</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>um1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idxm1</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>u</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idx</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>up1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idxp1</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>up2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idxp2</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>up3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@view</span><span class='hljl-t'> </span><span class='hljl-n'>fields</span><span class='hljl-p'>[</span><span class='hljl-n'>idxp3</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'>
        
        </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>max</span><span class='hljl-p'>(</span><span class='hljl-nf'>Speed_max</span><span class='hljl-p'>(</span><span class='hljl-n'>up3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>Speed_max</span><span class='hljl-p'>(</span><span class='hljl-n'>um3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>),</span><span class='hljl-t'> 
            </span><span class='hljl-nf'>Speed_max</span><span class='hljl-p'>(</span><span class='hljl-n'>up2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>Speed_max</span><span class='hljl-p'>(</span><span class='hljl-n'>um2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>Speed_max</span><span class='hljl-p'>(</span><span class='hljl-n'>up1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>),</span><span class='hljl-t'> 
            </span><span class='hljl-nf'>Speed_max</span><span class='hljl-p'>(</span><span class='hljl-n'>um1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>Speed_max</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-cs'>#maximum speed</span><span class='hljl-t'>
        
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pm3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>um3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pm2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>um2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pm1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>um1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pp1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>up1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pp2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>up2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>Fx!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pp3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>up3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>par_eq</span><span class='hljl-p'>)</span><span class='hljl-t'>
        
        
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mm3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pm3</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>um3</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mm2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pm2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>um2</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mm1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pm1</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>um1</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_M</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-t'>   </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pp1</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>up1</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pp2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>up2</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pp3</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>up3</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pm3</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>um3</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pm2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>um2</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pm1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>um1</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_P</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-t'>   </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pp1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pp1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>up1</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pp2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pp2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>up2</span><span class='hljl-p'>)</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pp3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Pp3</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>S_MAX</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>up3</span><span class='hljl-p'>)</span><span class='hljl-t'>
    
        </span><span class='hljl-nf'>MP5reconstruction!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_RM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp1</span><span class='hljl-p'>,</span><span class='hljl-t'>  </span><span class='hljl-n'>F_M</span><span class='hljl-p'>,</span><span class='hljl-t'>  </span><span class='hljl-n'>F_Mm1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mm2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_Fields</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>MP5reconstruction!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_LM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_P</span><span class='hljl-p'>,</span><span class='hljl-t'>  </span><span class='hljl-n'>F_Pp1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_Fields</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>MP5reconstruction!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_LP</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm1</span><span class='hljl-p'>,</span><span class='hljl-t'>  </span><span class='hljl-n'>F_P</span><span class='hljl-p'>,</span><span class='hljl-t'>  </span><span class='hljl-n'>F_Pp1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pp2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_Fields</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>MP5reconstruction!</span><span class='hljl-p'>(</span><span class='hljl-n'>F_RP</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_M</span><span class='hljl-p'>,</span><span class='hljl-t'>  </span><span class='hljl-n'>F_Mm1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_Fields</span><span class='hljl-p'>)</span><span class='hljl-t'>
        
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>H_p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>F_LP</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>F_RP</span><span class='hljl-t'>
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>H_m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>F_LM</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>F_RM</span><span class='hljl-t'>
        
        @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>dfields</span><span class='hljl-p'>[</span><span class='hljl-n'>idx</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>h</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>H_p</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>H_m</span><span class='hljl-p'>)</span><span class='hljl-t'>
        
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>createMP5auxvectors</span><span class='hljl-p'>(</span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_P</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Array</span><span class='hljl-p'>{</span><span class='hljl-n'>Float64</span><span class='hljl-p'>}(</span><span class='hljl-n'>undef</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_P</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_M</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Pm3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Pm2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Pm1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Pp1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Pp2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Pp3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Mm3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Mm2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Mm1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Mp1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Mp2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_Mp3</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>

    </span><span class='hljl-n'>F_LP</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_LM</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_RM</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_RP</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>H_m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>H_p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>F_P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F_Mm3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mm2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mm1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_M</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Mp3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pm1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pp1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pp2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_Pp3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_LP</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_LM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_RP</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F_RM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>H_m</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>H_p</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=output >
createMP5auxvectors &#40;generic function with 1 method&#41;
</pre> <p>We will use the Kurganov-Tadmor method &#40;which is second order and semidiscrete&#41;, WENO-Z, and MP5</p> <p>We define the maximum propagation speed. This is necessary to adjust the method&#39;s dissipation, as well as to ensure stability. What matters is to have a lower bound for the maximum wave propagation speed at any point.</p> <pre class='hljl'>
<span class='hljl-cs'>#Velocidad máxima de propagación</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>advectionspeed</span><span class='hljl-p'>(</span><span class='hljl-n'>U</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>burgersspeed</span><span class='hljl-p'>(</span><span class='hljl-n'>U</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-nf'>maximum</span><span class='hljl-p'>(</span><span class='hljl-n'>abs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>U</span><span class='hljl-p'>)</span><span class='hljl-t'> 
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>problem</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-sc'>:advection</span><span class='hljl-t'>
    </span><span class='hljl-n'>SpeedMax</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>advectionspeed</span><span class='hljl-t'>
</span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>problem</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-sc'>:burgers</span><span class='hljl-t'>
    </span><span class='hljl-n'>SpeedMax</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>burgersspeed</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=output >
burgersspeed &#40;generic function with 1 method&#41;
</pre> <p>Here we define the <code>Flux_x&#33;</code> function. Recall that we are solving problems of the form</p> <p class=math >\[ u_t = F(u)_x \]</p> <pre class='hljl'>
<span class='hljl-cs'>#Fluxes</span><span class='hljl-t'>
</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>advection!</span><span class='hljl-p'>(</span><span class='hljl-n'>F</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>U</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>
    @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>*</span><span class='hljl-n'>U</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>burgers!</span><span class='hljl-p'>(</span><span class='hljl-n'>F</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>U</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Fpars</span><span class='hljl-p'>)</span><span class='hljl-t'>
    @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>F</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-oB'>*</span><span class='hljl-n'>U</span><span class='hljl-oB'>*</span><span class='hljl-n'>U</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>problem</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-sc'>:advection</span><span class='hljl-t'>
    </span><span class='hljl-n'>Flux_x!</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>advection!</span><span class='hljl-t'>
</span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>problem</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-sc'>:burgers</span><span class='hljl-t'>
    </span><span class='hljl-n'>Flux_x!</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>burgers!</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=output >
burgers&#33; &#40;generic function with 1 method&#41;
</pre> <p>Now we finally begin to construct the problem. First, we define the spatial and temporal interval, along with the vector where we will store the solution. We also choose some parameters for the problem.</p> <pre class='hljl'>
<span class='hljl-cs'># --- Spatial Discretization ---</span><span class='hljl-t'>
</span><span class='hljl-n'>N</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>100</span><span class='hljl-t'>          </span><span class='hljl-cs'># Number of grid points</span><span class='hljl-t'>
</span><span class='hljl-n'>N_FIELDS</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>     </span><span class='hljl-cs'># Number of solution fields (e.g., 1 for a scalar equation)</span><span class='hljl-t'>

</span><span class='hljl-n'>domain_start</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>    </span><span class='hljl-cs'># Start of the spatial domain</span><span class='hljl-t'>
</span><span class='hljl-n'>domain_stop</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>2.0</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-t'> </span><span class='hljl-cs'># End of the spatial domain</span><span class='hljl-t'>

</span><span class='hljl-cs'># Create the spatial grid: N points, excluding the endpoint (domain_stop).</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-n'>domain_start</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>stop</span><span class='hljl-oB'>=</span><span class='hljl-n'>domain_stop</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-n'>N</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-k'>end</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>dx</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Float64</span><span class='hljl-p'>(</span><span class='hljl-nf'>step</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-cs'># Spatial step size (Δx)</span><span class='hljl-t'>
 </span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.0</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-n'>dx</span><span class='hljl-t'>         </span><span class='hljl-cs'># Inverse of dx</span><span class='hljl-t'>
 
</span><span class='hljl-cs'># --- Initial Condition ---</span><span class='hljl-t'>
</span><span class='hljl-cs'># Initialize the solution array &#39;u&#39; and a temporary array &#39;du&#39; (e.g., for Runge-Kutta stages or storing residuals)</span><span class='hljl-t'>
</span><span class='hljl-n'>u</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Array</span><span class='hljl-p'>{</span><span class='hljl-n'>Float64</span><span class='hljl-p'>}(</span><span class='hljl-n'>undef</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>du</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>similar</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'># Creates an array with the same dimensions and type as &#39;u&#39;, uninitialized.</span><span class='hljl-t'>

</span><span class='hljl-cs'># Set the initial condition: u(x,0) = 0.5 + sin(x)</span><span class='hljl-t'>
</span><span class='hljl-cs'># The @. macro broadcasts the operations element-wise.</span><span class='hljl-t'>
@</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-oB'>:</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-cs'># --- Temporal Discretization ---</span><span class='hljl-t'>
</span><span class='hljl-n'>T</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>4.0</span><span class='hljl-t'>          </span><span class='hljl-cs'># Total integration time</span><span class='hljl-t'>
</span><span class='hljl-n'>tspan</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'># Tuple defining the time interval [initial_time, final_time]</span><span class='hljl-t'>

</span><span class='hljl-cs'># CFL condition: CFL = speed * dt / dx.</span><span class='hljl-t'>
</span><span class='hljl-cs'># Here, we set the CFL number and calculate dt based on dx.</span><span class='hljl-t'>
</span><span class='hljl-cs'># The effective &#39;speed&#39; is implicitly 1 in this dt calculation,</span><span class='hljl-t'>
</span><span class='hljl-cs'># or the numerical scheme itself handles the actual wave speeds.</span><span class='hljl-t'>
</span><span class='hljl-n'>CFL</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.1</span><span class='hljl-t'>
</span><span class='hljl-n'>dt</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>dx</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>CFL</span><span class='hljl-t'>    </span><span class='hljl-cs'># Time step (Δt)</span><span class='hljl-t'>

</span><span class='hljl-cs'># --- Problem-Specific Parameters ---</span><span class='hljl-t'>
</span><span class='hljl-cs'># &#39;eqpars&#39; will hold parameters specific to the chosen PDE.</span><span class='hljl-t'>
</span><span class='hljl-cs'># This variable &#39;problem&#39; (a Symbol, e.g., :advection or :burgers)</span><span class='hljl-t'>
</span><span class='hljl-cs'># would need to be defined elsewhere in your script.</span><span class='hljl-t'>

</span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>problem</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-sc'>:advection</span><span class='hljl-t'>
    </span><span class='hljl-cs'># For an advection equation like u_t + a * u_x = 0,</span><span class='hljl-t'>
    </span><span class='hljl-cs'># &#39;eqpars&#39; could be the advection speed &#39;a&#39;.</span><span class='hljl-t'>
    </span><span class='hljl-n'>eqpars</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.0</span><span class='hljl-t'> </span><span class='hljl-cs'># Example: advection speed</span><span class='hljl-t'>
</span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>problem</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-sc'>:burgers</span><span class='hljl-t'>
    </span><span class='hljl-cs'># For Burgers&#39; equation u_t + (0.5 * u^2)_x = 0,</span><span class='hljl-t'>
    </span><span class='hljl-cs'># &#39;eqpars&#39; might not be needed if the non-linearity is handled directly in Flux_x!,</span><span class='hljl-t'>
    </span><span class='hljl-cs'># or it could be a coefficient if the equation was u_t + (coeff * u^2)_x = 0.</span><span class='hljl-t'>
    </span><span class='hljl-cs'># &#39;false&#39; is an unconventional parameter; it might signify that no external</span><span class='hljl-t'>
    </span><span class='hljl-cs'># scalar parameter is needed for the Burgers&#39; flux function, or it&#39;s a boolean flag</span><span class='hljl-t'>
    </span><span class='hljl-cs'># for some internal logic within the flux calculation.</span><span class='hljl-t'>
    </span><span class='hljl-n'>eqpars</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-t'> </span><span class='hljl-cs'># Placeholder or specific flag for Burgers&#39;</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=output >
false
</pre> <pre class='hljl'>
<span class='hljl-cs'>#Initial data</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-oB'>:</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;Dato inicial&quot;</span><span class='hljl-p'>)</span>
</pre> <img src="data:image/png;base64,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" /> <p>Here we choose the spatial resolution method and prepare the tuple <code>par</code> for later integration. Several of these functions are defined in <code>choques_utils.jl</code>.</p> <pre class='hljl'>
<span class='hljl-cs'># --- List of methods to compare ---</span><span class='hljl-t'>

</span><span class='hljl-cs'># Kurganov-Tadmor (KT2)</span><span class='hljl-t'>
</span><span class='hljl-cs'># θ: This value must be between 1.0 and 2.0.</span><span class='hljl-t'>
</span><span class='hljl-cs'>#    The closer it is to 2.0, the lower the dissipation.</span><span class='hljl-t'>
</span><span class='hljl-cs'>#    For systems of equations, it&#39;s better for it to be closer to 1.0 to avoid oscillations.</span><span class='hljl-t'>
</span><span class='hljl-n'>θ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>2.0</span><span class='hljl-t'>
</span><span class='hljl-n'>auxvectorsKT</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>createKTauxvectors</span><span class='hljl-p'>(</span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>parKT</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>eqpars</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>θ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Flux_x!</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>SpeedMax</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>auxvectorsKT</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-cs'># WENOZ</span><span class='hljl-t'>
</span><span class='hljl-n'>auxvectorsWENOZ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>createWENOZvectors</span><span class='hljl-p'>(</span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>parWENOZ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>eqpars</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Flux_x!</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>SpeedMax</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>auxvectorsWENOZ</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-cs'># MP5 (Monotonicity Preserving 5th order)</span><span class='hljl-t'>
</span><span class='hljl-n'>auxvectorsMP5</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>createMP5auxvectors</span><span class='hljl-p'>(</span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>parMP5</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>eqpars</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N_FIELDS</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Flux_x!</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>SpeedMax</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>auxvectorsMP5</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;createWENOZvectors&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p>The solution is a matrix of size <code>N x N_Fields</code>. For scalar problems, this essentially means it&#39;s a vector with a single column, but you can try it with systems of equations and it will work the same. Remember that for convergence analysis, it is convenient to use initial data that is smooth and piecewise polynomial.</p> <p>Now we are ready to define the problems, choose integrators, and set their behavior. Here it is important to choose a stable integrator, i.e., one whose stability region includes part of the imaginary axis, and preferably one that is TVD &#40;Total Variation Diminishing&#41;. In our case, we will choose the Runge-Kutta integrator <code>SSPRK33</code>, which is third-order in time and is TVD.</p> <pre class='hljl'>
<span class='hljl-n'>probKT</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>KT!</span><span class='hljl-p'>,</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>tspan</span><span class='hljl-p'>,</span><span class='hljl-n'>parKT</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-n'>probWENOZ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>wenoz!</span><span class='hljl-p'>,</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>tspan</span><span class='hljl-p'>,</span><span class='hljl-n'>parWENOZ</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-n'>probMP5</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>mp5!</span><span class='hljl-p'>,</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>tspan</span><span class='hljl-p'>,</span><span class='hljl-n'>parMP5</span><span class='hljl-p'>);</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;wenoz&#33;&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>solKT</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>probKT</span><span class='hljl-p'>,</span><span class='hljl-nf'>SSPRK33</span><span class='hljl-p'>(),</span><span class='hljl-n'>dt</span><span class='hljl-oB'>=</span><span class='hljl-n'>dt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>saveat</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-oB'>/</span><span class='hljl-ni'>100</span><span class='hljl-p'>);</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;mysign_zero&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>solWENOZ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>probWENOZ</span><span class='hljl-p'>,</span><span class='hljl-nf'>SSPRK33</span><span class='hljl-p'>(),</span><span class='hljl-n'>dt</span><span class='hljl-oB'>=</span><span class='hljl-n'>dt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>saveat</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-oB'>/</span><span class='hljl-ni'>100</span><span class='hljl-p'>);</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;probWENOZ&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>solMP5</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>probMP5</span><span class='hljl-p'>,</span><span class='hljl-nf'>SSPRK33</span><span class='hljl-p'>(),</span><span class='hljl-n'>dt</span><span class='hljl-oB'>=</span><span class='hljl-n'>dt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>saveat</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-oB'>/</span><span class='hljl-ni'>100</span><span class='hljl-p'>);</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;probMP5&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <p>Once we have the solution, we can analyze it. Here we show how to plot it.</p> <pre class='hljl'>
<span class='hljl-n'>anim</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@animate</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>solKT</span><span class='hljl-oB'>.</span><span class='hljl-n'>t</span><span class='hljl-t'>
    </span><span class='hljl-n'>plt</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>solKT</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>ylims</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;KT&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>plt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>solWENOZ</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>ylims</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;WENO-Z&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>plt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>solMP5</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>ylims</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;MP5&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>annotate!</span><span class='hljl-p'>(</span><span class='hljl-n'>plt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.9</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>text</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;T = </span><span class='hljl-si'>$</span><span class='hljl-p'>(</span><span class='hljl-nd'>@sprintf</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;%.2f&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>))</span><span class='hljl-s'>&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:black</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:left</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>20</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-nf'>gif</span><span class='hljl-p'>(</span><span class='hljl-n'>anim</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;burgers_sin.gif&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>fps</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>30</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;solKT&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <h3>Help for Convergence Analysis in KT</h3> <p>For the MP5 and WENOZ methods, you can analyze convergence using the <span class=math >$L_1$</span> norm. For the Kurganov-Tadmor method, you will need to use the <strong><span class=math >$Lip'$</span></strong> norm. We will provide the implementation of this norm and how to use it to calculate the factor <span class=math >$Q$</span>.</p> <pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>Lipprime</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dx</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>pr</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-nf'>size</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-p'>])</span><span class='hljl-t'>
    </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-oB'>:</span><span class='hljl-nf'>size</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>pr</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>pr</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-oB'>+</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>])</span><span class='hljl-oB'>*</span><span class='hljl-n'>dx</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-n'>abs</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>pr</span><span class='hljl-p'>))</span><span class='hljl-oB'>*</span><span class='hljl-n'>dx</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>QKT</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>sol1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>sol2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>sol4</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dx1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dx2</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>n1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Lipprime</span><span class='hljl-p'>(</span><span class='hljl-nf'>sol1</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)[</span><span class='hljl-oB'>:</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-nf'>sol2</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>2</span><span class='hljl-oB'>:</span><span class='hljl-k'>end</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>dx1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>n2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Lipprime</span><span class='hljl-p'>(</span><span class='hljl-nf'>sol2</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)[</span><span class='hljl-oB'>:</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-nf'>sol4</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>2</span><span class='hljl-oB'>:</span><span class='hljl-k'>end</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>dx2</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-nf'>log2</span><span class='hljl-p'>(</span><span class='hljl-n'>n1</span><span class='hljl-oB'>/</span><span class='hljl-n'>n2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=output >
QKT &#40;generic function with 1 method&#41;
</pre> <pre class='hljl'>

</pre> <footer> <p> Published from <a href=Conservative_schemes.ipynb >Conservative_schemes.ipynb</a> using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.12 on 2025-06-04. </p> </footer> </div> <div class=back-to-top > <span><a href="#" title="Back to Top"><i class="fa fa-chevron-circle-up"></i></a></span> </div> </div> </div> </div>