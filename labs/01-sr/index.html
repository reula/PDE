<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/PDE/css/franklin.css"> <link rel=stylesheet  href="/PDE/css/tufte.css"> <link rel=stylesheet  href="/PDE/css/latex.css"> <link rel=stylesheet  href="/PDE/css/adjust.css"> <link rel=icon  href="/PDE/assets/favicon.png"> <link rel=stylesheet  href="/PDE/css/weave.css"> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}, TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <title>Lab 1 Ordinary Differential Equations</title> <div id=layout > <div id=menu > <ul> <li><a style="font-size:larger;" href="/PDE/">Home</a> <li><a style="font-size:larger;" href="/PDE/schedule/">Course Schedule</a> <li><a style="font-size:larger;" href="/PDE/homework/">Homework</a> <li><a style="font-size:larger;" href="/PDE/labs/">Labs</a> <li><a style="font-size:larger;" href="/PDE/bibliography/">Bibliography</a> <!-- <li><a style="font-size:larger;" href="/PDE/notes/">Notes</a> <ul style="font-size:smaller"> <li><a href="/PDE/notes/lecture01/">01: Linear Algebra</a> <li><a href="/PDE/notes/lecture02/">02: Topology</a> <li><a href="/PDE/notes/lecture05/">05: ODEs</a> </ul> --> </ul> </div> <div id=main > <div class=franklin-content > <!DOCTYPE html> <html lang=en > <meta charset=UTF-8 > <title></title> <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/PDE/css/tufte.css"> <link rel=stylesheet  href="/PDE/css/franklin.css"> <link rel=stylesheet  href="/PDE/css/adjust.css"> <link rel=stylesheet  href="/PDE/css/latex.css"> <link rel=stylesheet  href="/PDE/css/weave.css"> <style> </style> <script> window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }, svg: { fontCache: 'global' } }; </script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" async></script> <div class=franklin-content > <h2>Stability Region of Integrators</h2> <h3>Oscar Reula</h3> <h5><a href="/PDE/weave/lab01/stability_region.ipynb">&#40;notebook version&#41;</a></h5> <p>The stability region is the region in the complex plane where the amplification factor of the integrator is smaller than one when solving for <span class=math >$u_t = \lambda u$</span>. To do that we solve the system for the vector <span class=math >$(u_r, u_i)$</span>. One can also use complex algebra.</p> <p class=math >\[ \begin{aligned} \frac{d}{dt} \left( \begin{array}{c} u_r \\ u_i \end{array} \right) &=& \left( \begin{array}{cc} \lambda_r & -\lambda_i \\ \lambda_i & \lambda_r \end{array} \right) \left( \begin{array}{c} u_r \\ u_i \end{array} \right) \end{aligned} \]</p> <p>When discretizating in time we obtain an algorithm for the discrete approximation:</p> <p class=math >\[ \begin{aligned} \left( \begin{array}{c} v^{n+1}_r \\ v^{n+1}_i \end{array} \right) &=& \left( \begin{array}{c} v^{n}_r \\ v^{n}_i \end{array} \right) + \left( \begin{array}{cc} A^1{}_1 & A^1{}_2 \\ A^2{}_1 & A^2{}_2 \end{array} \right) \left( \begin{array}{c} v^{n}_r \\ v^{n}_i \end{array} \right) =\left( \begin{array}{cc} F^1{}_1 & F^1{}_2 \\ F^2{}_1 & F^2{}_2 \end{array} \right) \left( \begin{array}{c} v^{n}_r \\ v^{n}_i \end{array} \right) \end{aligned} \]</p> <p>Where </p> <p class=math >\[ \begin{aligned} \left( \begin{array}{c} F^1{}_1 & F^1{}_2 \\ F^2{}_1 & F^2{}_2 \end{array} \right) &=& \left( \begin{array}{c} F((1,0)) & F((0.1)) \end{array} \right) \end{aligned} \]</p> <p>And <span class=math >$F(u)$</span> is one step &#40;with <span class=math >$dt=1$</span>&#41; of the method used. </p> <p>The amplification factor is then the norm of the <span class=math >$F$</span> matrix. which in turn is given by the largest eigenvalue &#40;in absolute value&#41;. </p> <p>The eigenvalues are given by:</p> <p class=math >\[ \begin{equation} \sigma_{\pm} = \frac{1}{2}(F^1{}_1 + F^2{}_2 \pm \sqrt{(F^1{}_1 - F^2{}_2)^2 + 4 F^1{}_2 F^2{}_1}) \end{equation} \]</p> <p>Since the coefficients are all real then if the discriminat is positive the roots are real and so we take the largest in absolute value.</p> <p>On the other hand, if it is negative then the absolute value squared is given by, the determinant of <span class=math >$F$</span> &#40;the product of eigenvalues, since they are conjugated.</p> <p>For instance, for the Euler explicit method, namely &#40;dt&#61;1&#41;</p> <p>\begin&#123;equation&#125; v^&#123;n&#43;1&#125; &#61; v^n &#43; \lambda v^n &#61; &#40;1&#43;\lambda&#41; v^n \end&#123;equation&#125;</p> <p>The matrix is:</p> <p class=math >\[ \left( \begin{array}{c} 1 + \lambda_r & -i \lambda_i \\ \lambda_i & 1 +\lambda_r \end{array} \right) \]</p> <p class=math >\[ \sigma_{\pm} = 1 + \lambda_r \pm i \lambda_i \]</p> <p>Therefore, </p> <p class=math >\[ \begin{aligned} |\sigma_{\pm}|^2 &=& \sigma_+ \sigma_- \\ &=& (-1 - \lambda_r)^2 + \lambda_i^2 \\ &=& | (-1,0) - (\lambda_r, \lambda_i)|^2 \end{aligned} \]</p> <p>Thus the stability region is the unit circle around the point <span class=math >$(-1,0)$</span> of the complex plane.</p> <pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>OrdinaryDiffEq</span><span class='hljl-t'>
</span><span class='hljl-cs'>#using ODE</span><span class='hljl-t'>
</span><span class='hljl-cs'>#using Sundials</span><span class='hljl-t'>
</span><span class='hljl-cs'>#using LSODA</span>
</pre> <pre class=julia-error >
ERROR: ArgumentError: Package OrdinaryDiffEq not found in current path.
- Run &#96;import Pkg; Pkg.add&#40;&quot;OrdinaryDiffEq&quot;&#41;&#96; to install the OrdinaryDiffEq package.
</pre> <p>After calling the Ordinary Differential Equations Package we define the function to integrate, in our case it is just <span class=math >$u_t = \lambda u$</span></p> <pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>du</span><span class='hljl-p'>,</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>par</span><span class='hljl-p'>,</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>λ_r</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>λ_i</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>par</span><span class='hljl-t'>
    </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>λ_r</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>λ_i</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>λ_i</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>λ_r</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=output >
f &#40;generic function with 2 methods&#41;
</pre> <p>Now we define an index function which returns 1 if the <span class=math >$\lambda$</span> value is stable, otherwise returns 0.</p> <pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>stability_index</span><span class='hljl-p'>(</span><span class='hljl-n'>par</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-cs'># first the two initial values needed for computing the matrix F</span><span class='hljl-t'>
    </span><span class='hljl-n'>u_p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nfB'>1.</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-n'>u_m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nfB'>0.</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.</span><span class='hljl-p'>]</span><span class='hljl-t'>

    </span><span class='hljl-cs'># for time we put T = dt = 1 so that there will be just one step</span><span class='hljl-t'>
    </span><span class='hljl-n'>T</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1.</span><span class='hljl-t'> 
    </span><span class='hljl-n'>tspan</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-cs'># we put some values for the errors, probably they can be taken away, </span><span class='hljl-t'>
    </span><span class='hljl-cs'># but in some cases they can go to defaults and create problems.</span><span class='hljl-t'>
    </span><span class='hljl-n'>reltol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>2.</span><span class='hljl-t'>
    </span><span class='hljl-n'>abstol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>2.</span><span class='hljl-t'>
    </span><span class='hljl-cs'># we create the two problems (different initial conditions)</span><span class='hljl-t'>
    </span><span class='hljl-n'>prob_p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-n'>u_p</span><span class='hljl-p'>,</span><span class='hljl-n'>tspan</span><span class='hljl-p'>,</span><span class='hljl-n'>par</span><span class='hljl-p'>);</span><span class='hljl-t'>
    </span><span class='hljl-n'>prob_m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-n'>u_m</span><span class='hljl-p'>,</span><span class='hljl-n'>tspan</span><span class='hljl-p'>,</span><span class='hljl-n'>par</span><span class='hljl-p'>);</span><span class='hljl-t'>
    
    </span><span class='hljl-cs'># and solve them. Notice that we take adaptive = false, so that the methods will not change anything</span><span class='hljl-t'>
    </span><span class='hljl-n'>v_p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob_p</span><span class='hljl-p'>,</span><span class='hljl-n'>method</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltol</span><span class='hljl-oB'>=</span><span class='hljl-n'>reltol</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstol</span><span class='hljl-oB'>=</span><span class='hljl-n'>abstol</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>adaptive</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dtmin</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dt</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>save_everystep</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>);</span><span class='hljl-t'>
    </span><span class='hljl-n'>v_m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob_m</span><span class='hljl-p'>,</span><span class='hljl-n'>method</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltol</span><span class='hljl-oB'>=</span><span class='hljl-n'>reltol</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstol</span><span class='hljl-oB'>=</span><span class='hljl-n'>abstol</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>adaptive</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dtmin</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dt</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>save_everystep</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>);</span><span class='hljl-t'>
    
    </span><span class='hljl-cs'>#We take the values at T=1.</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>v_p</span><span class='hljl-oB'>.</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-k'>end</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-n'>F_m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>v_m</span><span class='hljl-oB'>.</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-k'>end</span><span class='hljl-p'>]</span><span class='hljl-t'>
    
    </span><span class='hljl-cs'># and build the F matrix</span><span class='hljl-t'>
    </span><span class='hljl-n'>F11</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>F_p</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-n'>F12</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>F_m</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-n'>F21</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>F_p</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-n'>F22</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>F_m</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
    
    </span><span class='hljl-cs'># now we can compute the maximum, that is the spectral radius.</span><span class='hljl-t'>
    
    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F11</span><span class='hljl-oB'>-</span><span class='hljl-n'>F22</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nfB'>4.</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F12</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>F21</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.</span><span class='hljl-t'>
        </span><span class='hljl-n'>σ_p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>((</span><span class='hljl-n'>F11</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>F22</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>((</span><span class='hljl-n'>F11</span><span class='hljl-oB'>-</span><span class='hljl-n'>F22</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nfB'>4.</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F12</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>F21</span><span class='hljl-p'>)))</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-nfB'>2.</span><span class='hljl-t'>
        </span><span class='hljl-n'>σ_m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>((</span><span class='hljl-n'>F11</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>F22</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>((</span><span class='hljl-n'>F11</span><span class='hljl-oB'>-</span><span class='hljl-n'>F22</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nfB'>4.</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>F12</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>F21</span><span class='hljl-p'>)))</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-nfB'>2.</span><span class='hljl-t'>
        </span><span class='hljl-n'>max</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>maximum</span><span class='hljl-p'>([</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>σ_p</span><span class='hljl-p'>);</span><span class='hljl-t'> </span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>σ_m</span><span class='hljl-p'>)])</span><span class='hljl-t'>
    </span><span class='hljl-k'>else</span><span class='hljl-t'>
        </span><span class='hljl-n'>max</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>F11</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>F22</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>F12</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>F21</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    
    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>max</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.</span><span class='hljl-t'> </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.</span><span class='hljl-t'>
        </span><span class='hljl-k'>else</span><span class='hljl-t'> </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=output >
stability_index &#40;generic function with 1 method&#41;
</pre> <p>A list of possible methods is here: https://diffeq.sciml.ai/stable/solvers/ode_solve/</p> <pre class='hljl'>
<span class='hljl-cs'>#method = Tsit5()</span><span class='hljl-t'>
</span><span class='hljl-n'>methods</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>Euler</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-nf'>Heun</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-nf'>RK4</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-nf'>Tsit5</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-nf'>SSPRK33</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-nf'>SSPRK54</span><span class='hljl-p'>())</span><span class='hljl-t'>
</span><span class='hljl-cs'>#method = Heun()</span><span class='hljl-t'>
</span><span class='hljl-cs'>#method = RK4()</span><span class='hljl-t'>


</span><span class='hljl-cs'>#stability_index((-2.,0.0), method)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;Euler&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Plots</span><span class='hljl-t'>

</span><span class='hljl-cs'>#Plots.PlotlyBackend()</span><span class='hljl-t'>
</span><span class='hljl-cs'>#using ImageMagick (sometimes needed for animations)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#using PyPlot</span><span class='hljl-t'>
</span><span class='hljl-cs'>#ioff() # Interactive plotting OFF, necessary for inline plotting in IJulia</span>
</pre> <pre class='hljl'>
<span class='hljl-nf'>default</span><span class='hljl-p'>(</span><span class='hljl-n'>size</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-ni'>600</span><span class='hljl-p'>,</span><span class='hljl-ni'>900</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>fc</span><span class='hljl-oB'>=:</span><span class='hljl-n'>heat</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>5.5</span><span class='hljl-oB'>:</span><span class='hljl-nfB'>0.02</span><span class='hljl-oB'>:</span><span class='hljl-nfB'>0.5</span><span class='hljl-t'>
</span><span class='hljl-n'>y</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>5</span><span class='hljl-oB'>:</span><span class='hljl-nfB'>0.01</span><span class='hljl-oB'>:</span><span class='hljl-ni'>5</span><span class='hljl-t'>
</span><span class='hljl-n'>X</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>repeat</span><span class='hljl-p'>(</span><span class='hljl-nf'>reshape</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>Y</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>repeat</span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>));</span>
</pre> <pre class='hljl'>
<span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>heatmap</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-oB'>-&gt;</span><span class='hljl-nf'>stability_index</span><span class='hljl-p'>((</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>),</span><span class='hljl-nf'>Euler</span><span class='hljl-p'>()))</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;Euler&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>heatmap</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-oB'>-&gt;</span><span class='hljl-nf'>stability_index</span><span class='hljl-p'>((</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>),</span><span class='hljl-nf'>Heun</span><span class='hljl-p'>()))</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;Heun&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>heatmap</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-oB'>-&gt;</span><span class='hljl-nf'>stability_index</span><span class='hljl-p'>((</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>),</span><span class='hljl-nf'>RK4</span><span class='hljl-p'>()))</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;RK4&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>heatmap</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-oB'>-&gt;</span><span class='hljl-nf'>stability_index</span><span class='hljl-p'>((</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>),</span><span class='hljl-nf'>Tsit5</span><span class='hljl-p'>()))</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;Tsit5&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>heatmap</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-oB'>-&gt;</span><span class='hljl-nf'>stability_index</span><span class='hljl-p'>((</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>),</span><span class='hljl-nf'>SSPRK33</span><span class='hljl-p'>()))</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;SSPRK33&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>
<span class='hljl-nf'>default</span><span class='hljl-p'>(</span><span class='hljl-n'>size</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-ni'>600</span><span class='hljl-p'>,</span><span class='hljl-ni'>600</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>fc</span><span class='hljl-oB'>=:</span><span class='hljl-n'>heat</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>3.5</span><span class='hljl-oB'>:</span><span class='hljl-nfB'>0.1</span><span class='hljl-oB'>:</span><span class='hljl-nfB'>0.5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>3.5</span><span class='hljl-oB'>:</span><span class='hljl-nfB'>0.1</span><span class='hljl-oB'>:</span><span class='hljl-nfB'>3.5</span><span class='hljl-t'>
</span><span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Surface</span><span class='hljl-p'>((</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-oB'>-&gt;</span><span class='hljl-nf'>stability_index</span><span class='hljl-p'>((</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>),</span><span class='hljl-nf'>Euler</span><span class='hljl-p'>()),</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>surface</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>z</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linealpha</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.3</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'>#stability_index((1,2),Euler())</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;Euler&#96; not defined in &#96;Main&#96;
Suggestion: check for spelling errors or missing imports.
</pre> <pre class='hljl'>

</pre> <footer> <p> Published from <a href=stability_region.ipynb >stability_region.ipynb</a> using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.12 on 2025-05-14. </p> </footer> </div> <div class=back-to-top > <span><a href="#" title="Back to Top"><i class="fa fa-chevron-circle-up"></i></a></span> </div> </div> </div> </div>